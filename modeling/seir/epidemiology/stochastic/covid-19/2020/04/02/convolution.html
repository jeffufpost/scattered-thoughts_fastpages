<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Epidemic modeling - Part 7 | Scattered Thoughts</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Epidemic modeling - Part 7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Convolution, deconvolution, and daily data" />
<meta property="og:description" content="Convolution, deconvolution, and daily data" />
<link rel="canonical" href="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html" />
<meta property="og:url" content="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html" />
<meta property="og:site_name" content="Scattered Thoughts" />
<meta property="og:image" content="https://jeffufpost.github.io/scattered-thoughts/images/kalman_filter.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-02T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-04-02T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html"},"image":"https://jeffufpost.github.io/scattered-thoughts/images/kalman_filter.jpg","description":"Convolution, deconvolution, and daily data","@type":"BlogPosting","url":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html","headline":"Epidemic modeling - Part 7","dateModified":"2020-04-02T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/scattered-thoughts/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jeffufpost.github.io/scattered-thoughts/feed.xml" title="Scattered Thoughts" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-166290391-2','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/scattered-thoughts/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Epidemic modeling - Part 7 | Scattered Thoughts</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Epidemic modeling - Part 7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Convolution, deconvolution, and daily data" />
<meta property="og:description" content="Convolution, deconvolution, and daily data" />
<link rel="canonical" href="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html" />
<meta property="og:url" content="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html" />
<meta property="og:site_name" content="Scattered Thoughts" />
<meta property="og:image" content="https://jeffufpost.github.io/scattered-thoughts/images/kalman_filter.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-02T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-04-02T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html"},"image":"https://jeffufpost.github.io/scattered-thoughts/images/kalman_filter.jpg","description":"Convolution, deconvolution, and daily data","@type":"BlogPosting","url":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html","headline":"Epidemic modeling - Part 7","dateModified":"2020-04-02T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://jeffufpost.github.io/scattered-thoughts/feed.xml" title="Scattered Thoughts" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-166290391-2','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/scattered-thoughts/">Scattered Thoughts</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/scattered-thoughts/about/">About Me</a><a class="page-link" href="/scattered-thoughts/search/">Search</a><a class="page-link" href="/scattered-thoughts/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Epidemic modeling - Part 7</h1><p class="page-description">Convolution, deconvolution, and daily data</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-02T00:00:00-05:00" itemprop="datePublished">
        Apr 2, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#modeling">modeling</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#SEIR">SEIR</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#epidemiology">epidemiology</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#stochastic">stochastic</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#COVID-19">COVID-19</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/jeffufpost/scattered-thoughts/tree/master/_notebooks/2020-04-02-convolution.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/scattered-thoughts/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jeffufpost/scattered-thoughts/master?filepath=_notebooks%2F2020-04-02-convolution.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/scattered-thoughts/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jeffufpost/scattered-thoughts/blob/master/_notebooks/2020-04-02-convolution.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/scattered-thoughts/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Motivation-for-write-up">Motivation for write-up </a></li>
<li class="toc-entry toc-h2"><a href="#Available-data">Available data </a></li>
<li class="toc-entry toc-h2"><a href="#Convolution">Convolution </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Convolution-to-get-$I_{pd}$">Convolution to get $I_{pd}$ </a></li>
<li class="toc-entry toc-h3"><a href="#Convolution-to-get-$R_{pd}$">Convolution to get $R_{pd}$ </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Finding-$h_L[j]$-and-$h_I[j]$">Finding $h_L[j]$ and $h_I[j]$ </a></li>
<li class="toc-entry toc-h2"><a href="#Convolution-in-practice">Convolution in practice </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Comparing-$I_{pd}$-from-the-model-to-$I_{pd}$-obtained-by-convolving-$R_{pd}$">Comparing $I_{pd}$ from the model to $I_{pd}$ obtained by convolving $R_{pd}$ </a></li>
<li class="toc-entry toc-h3"><a href="#Comparing-$R_{pd}$-from-the-model-to-$R_{pd}$-obtained-by-convolving-$I_{pd}$">Comparing $R_{pd}$ from the model to $R_{pd}$ obtained by convolving $I_{pd}$ </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#De-convolution">De-convolution </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Problems-with-de-convolution">Problems with de-convolution </a></li>
<li class="toc-entry toc-h3"><a href="#Solutions-to-these-problems">Solutions to these problems </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Iterative-deconvoluton">Iterative deconvoluton </a></li>
<li class="toc-entry toc-h4"><a href="#Low-pass-filter">Low-pass filter </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Deconvolution-in-practice">Deconvolution in practice </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Coding-the-iterative-deconvolution">Coding the iterative deconvolution </a></li>
<li class="toc-entry toc-h3"><a href="#Comparing-$E_{pd}$-from-the-model-to-$E_{pd}$-obtained-by-de-convolving-$I_{pd}$">Comparing $E_{pd}$ from the model to $E_{pd}$ obtained by de-convolving $I_{pd}$ </a></li>
<li class="toc-entry toc-h3"><a href="#Comparing-$I_{pd}$-from-the-model-to-$I_{pd}$-obtained-by-de-convolving-$R_{pd}$">Comparing $I_{pd}$ from the model to $I_{pd}$ obtained by de-convolving $R_{pd}$ </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Discussion">Discussion </a></li>
</ul><body>
<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-02-convolution.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/jeffufpost/scattered-thoughts/blob/master/_notebooks/2020-04-02-convolution.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/scattered-thoughts/images/copied_from_nb/my_icons/kalman_filter.jpg" alt="" title="https://fr.mathworks.com/videos/understanding-kalman-filters-part-3-optimal-state-estimator--1490710645421.html"></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="o">!</span>pip install <span class="nv">plotly</span><span class="o">==</span><span class="m">4</span>.9.0
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>

<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">expon</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">weibull_min</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>

<span class="c1"># Let's build a numerical solution</span>
<span class="k">def</span> <span class="nf">seir_model</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">parms</span><span class="p">,</span> <span class="n">days</span><span class="p">):</span>
    <span class="n">S_0</span><span class="p">,</span> <span class="n">E_0</span><span class="p">,</span> <span class="n">I_0</span><span class="p">,</span> <span class="n">R_0</span> <span class="o">=</span> <span class="n">init</span>
    <span class="n">Epd</span><span class="p">,</span> <span class="n">Ipd</span><span class="p">,</span> <span class="n">Rpd</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_0</span><span class="p">],</span> <span class="p">[</span><span class="n">E_0</span><span class="p">],</span> <span class="p">[</span><span class="n">I_0</span><span class="p">],</span> <span class="p">[</span><span class="n">R_0</span><span class="p">]</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">days</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">days</span><span class="o">/</span><span class="n">dt</span><span class="p">))</span>
    <span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gam</span> <span class="o">=</span> <span class="n">parms</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">next_S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">Epd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">next_E</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sigma</span><span class="o">*</span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">Ipd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">next_I</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">sigma</span><span class="o">*</span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">gam</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">Rpd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gam</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">next_R</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">gam</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_S</span><span class="p">)</span>
        <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_E</span><span class="p">)</span>
        <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_I</span><span class="p">)</span>
        <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_R</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">Epd</span><span class="p">,</span> <span class="n">Ipd</span><span class="p">,</span> <span class="n">Rpd</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting plotly==4.9.0
  Downloading https://files.pythonhosted.org/packages/bf/5f/47ab0d9d843c5be0f5c5bd891736a4c84fa45c3b0a0ddb6b6df7c098c66f/plotly-4.9.0-py2.py3-none-any.whl (12.9MB)
     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12.9MB 313kB/s 
Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from plotly==4.9.0) (1.15.0)
Requirement already satisfied: retrying&gt;=1.3.3 in /usr/local/lib/python3.6/dist-packages (from plotly==4.9.0) (1.3.3)
Installing collected packages: plotly
  Found existing installation: plotly 4.4.1
    Uninstalling plotly-4.4.1:
      Successfully uninstalled plotly-4.4.1
Successfully installed plotly-4.9.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1"># Need this new function for model below:</span>
<span class="k">def</span> <span class="nf">make_df</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">'S'</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'State'</span><span class="p">])</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">'Day'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">tochange</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_E</span><span class="o">+</span><span class="n">num_I</span><span class="o">+</span><span class="n">num_R</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="s1">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tochange</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_E</span><span class="p">],</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'E'</span>
  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tochange</span><span class="p">[</span><span class="n">num_E</span><span class="p">:</span><span class="n">num_I</span><span class="o">+</span><span class="n">num_E</span><span class="p">],</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'I'</span>
  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tochange</span><span class="p">[</span><span class="n">num_E</span><span class="o">+</span><span class="n">num_I</span><span class="p">:</span><span class="n">num_E</span><span class="o">+</span><span class="n">num_I</span><span class="o">+</span><span class="n">num_R</span><span class="p">],</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'R'</span>
  <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="k">def</span> <span class="nf">seir_model_stoch</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">):</span>

    <span class="c1"># Initialize population dataframe with data given by user</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">)</span>
    
    <span class="c1"># This variable is used to track daily value of beta if it varies over time</span>
    <span class="n">xxbeta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Initialize the arrays to return</span>
    <span class="c1"># Below are numbers of S, E, I, R total</span>
    <span class="n">S</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">I</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Below are the daily additions in S, E, I, R</span>
    <span class="n">Spd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">Epd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">Ipd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">Rpd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">b</span><span class="o">=</span><span class="n">beta</span>
    
    <span class="c1"># Stochastic model so use random values to decide on progression</span>
    <span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">days</span><span class="p">))</span>

    <span class="c1"># Depending if you want exponential or gamma distribution for T_Latent</span>
    <span class="n">EtoI</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">5.2</span><span class="o">-</span><span class="mf">1.8</span><span class="p">)</span><span class="o">/</span><span class="mf">0.9</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># Depending if you want exponential, gamma, or Weibull distribution for T_Infectious</span>
    <span class="c1"># Uses distributions found on blog part 3</span>
    <span class="n">ItoR</span> <span class="o">=</span> <span class="n">weibull_min</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">20.11</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># Iterate over every day the simulation is run</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">days</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="c1"># Record daily beta values</span>
        <span class="n">xxbeta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="c1"># First we get the index of the individuals that will change state today:</span>

        <span class="c1"># Random number tells you which 'S' have been exposed on this day </span>
        <span class="n">StoE_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="s1">'S'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rand</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'I'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">p</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>

        <span class="c1"># For each row, if a person has been a certain number of days in E, they will go to I</span>
        <span class="c1"># This follows EtoI variable which is either exponential or gamma distributed according to above</span>
        <span class="n">EtoI_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="s1">'E'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">df</span><span class="o">.</span><span class="n">Day</span> <span class="o">&gt;=</span> <span class="n">EtoI</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
        
        <span class="c1"># Similaraly as above</span>
        <span class="c1"># For each row, if a person has been a certain number of days in I, they will go to R</span>
        <span class="c1"># This follows EtoI variable which is either exponential or gamma distributed according to above</span>
        <span class="n">ItoR_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="s1">'I'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">df</span><span class="o">.</span><span class="n">Day</span> <span class="o">&gt;=</span> <span class="n">ItoR</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>

        <span class="c1"># Use indexes collected above to populate per day values</span>
        <span class="n">Epd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Epd</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">StoE_index</span><span class="p">))</span>
        <span class="n">Ipd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ipd</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">EtoI_index</span><span class="p">))</span>
        <span class="n">Rpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rpd</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ItoR_index</span><span class="p">))</span>

        <span class="c1"># Now we use the indexes collected above randomly to change the actual population dataframe to the new states</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ItoR_index</span><span class="p">,</span> <span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'R'</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">EtoI_index</span><span class="p">,</span> <span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'I'</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">StoE_index</span><span class="p">,</span> <span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'E'</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ItoR_index</span><span class="p">,</span> <span class="s1">'Day'</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">EtoI_index</span><span class="p">,</span> <span class="s1">'Day'</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">StoE_index</span><span class="p">,</span> <span class="s1">'Day'</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ItoR_index</span><span class="p">,</span> <span class="s1">'DayR'</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">EtoI_index</span><span class="p">,</span> <span class="s1">'DayI'</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">StoE_index</span><span class="p">,</span> <span class="s1">'DayE'</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
        
        <span class="c1"># Append the S, E, I, and R arrays</span>
        <span class="n">S</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'S'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'E'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">I</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'I'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'R'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c1"># Code below for control measures to reduce beta values</span>
<span class="c1">#        if ((I[-1] &gt; 1000) &amp; (Ipd[-1] &gt; 399)): </span>
<span class="c1">#            b = beta2</span>
<span class="c1">#        elif ((I[-1] &gt; 1000) &amp; (Ipd[-1] &lt; 400)): </span>
<span class="c1">#            b = beta3</span>
                
    <span class="n">Epd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">num_E</span>
    <span class="n">Ipd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">num_I</span>
    <span class="n">Rpd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">num_R</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">R</span><span class="p">,</span> <span class="n">Epd</span><span class="p">,</span> <span class="n">Ipd</span><span class="p">,</span> <span class="n">Rpd</span><span class="p">,</span> <span class="n">xxbeta</span><span class="p">,</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivation-for-write-up">
<a class="anchor" href="#Motivation-for-write-up" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation for write-up<a class="anchor-link" href="#Motivation-for-write-up"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the 7th part of a multi-part series blog post on modeling in epidemiology.</p>
<p>The goal of this 7th installment is to expand on the notions seen in part 5.</p>
<p>Most notably, the idea is to expand on the notion of convolution and deconvolution and to see how it can be useful to describe an epidemic.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Available-data">
<a class="anchor" href="#Available-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Available data<a class="anchor-link" href="#Available-data"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you look at the the COVID-19 trackers around the web, or even <a href="https://sars-cov-2-world-tracker.herokuapp.com/">mine</a>, you can get a sense of what data is available for study.</p>
<p>Generally speaking we have the following:</p>
<ul>
<li>Total number of positive individuals</li>
<li>Daily number of newly diagnosed individuals</li>
<li>Daily number of recovered individuals</li>
<li>Daily number of deaths</li>
</ul>
<p>Research has also shown some vague numbers on both $T_{Latent}$ and $T_{Infectious}$.</p>
<p><strong>About the data:</strong></p>
<ul>
<li>We don't have data for exposure - how can we get it using deconvolution ??</li>
<li>The data for some regions can be very sparse</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convolution">
<a class="anchor" href="#Convolution" aria-hidden="true"><span class="octicon octicon-link"></span></a>Convolution<a class="anchor-link" href="#Convolution"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Convolution-to-get-$I_{pd}$">
<a class="anchor" href="#Convolution-to-get-%24I_%7Bpd%7D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Convolution to get $I_{pd}$<a class="anchor-link" href="#Convolution-to-get-%24I_%7Bpd%7D%24"> </a>
</h3>
<p>We have seen that daily new infectious individuals is given by:</p>
<p>
$$I_{pd}[j] = \sum_{n_L=0}^{M_L-1}h_L[n_L]~E_{pd}[j-n_L]= h_L[j]\circledast E_{pd}[j]$$
</p>
<p>Where $h_L[j]$ describes the distribution of $T_{Latent}$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Convolution-to-get-$R_{pd}$">
<a class="anchor" href="#Convolution-to-get-%24R_%7Bpd%7D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Convolution to get $R_{pd}$<a class="anchor-link" href="#Convolution-to-get-%24R_%7Bpd%7D%24"> </a>
</h3>
<p>Similarly, we have seen that daily new recovered individuals (deaths + recoveries in fact) is given by:</p>
<p>
$$R_{pd}[j] = \sum_{n_I=0}^{M_I-1}h_I[n_I]~I_{pd}[j-n_I]= h_I[j]\circledast I_{pd}[j]$$
</p>
<p>Where $h_I[j]$ describes the distribution of $T_{Infectious}$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finding-$h_L[j]$-and-$h_I[j]$">
<a class="anchor" href="#Finding-%24h_L%5Bj%5D%24-and-%24h_I%5Bj%5D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Finding $h_L[j]$ and $h_I[j]$<a class="anchor-link" href="#Finding-%24h_L%5Bj%5D%24-and-%24h_I%5Bj%5D%24"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>$h_L[j]$ is simply the probability of an individual having a latent period of j days</li>
<li>$h_I[j]$ is similarly the probability of an individual having an infectious period of j days  </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'T_Latent'</span><span class="p">:</span> <span class="n">gamma</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">5.2</span><span class="o">-</span><span class="mf">1.8</span><span class="p">)</span><span class="o">/</span><span class="mf">0.9</span><span class="p">),</span> 
    <span class="s1">'T_Infectious'</span><span class="p">:</span> <span class="n">weibull_min</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">20.11</span><span class="p">)</span>
    <span class="p">})</span>
<span class="n">h_L</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">T_Latent</span>
<span class="n">h_I</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">T_Infectious</span>
<span class="n">h_L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">h_I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convolution-in-practice">
<a class="anchor" href="#Convolution-in-practice" aria-hidden="true"><span class="octicon octicon-link"></span></a>Convolution in practice<a class="anchor-link" href="#Convolution-in-practice"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-$I_{pd}$-from-the-model-to-$I_{pd}$-obtained-by-convolving-$R_{pd}$">
<a class="anchor" href="#Comparing-%24I_%7Bpd%7D%24-from-the-model-to-%24I_%7Bpd%7D%24-obtained-by-convolving-%24R_%7Bpd%7D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comparing $I_{pd}$ from the model to $I_{pd}$ obtained by convolving $R_{pd}$<a class="anchor-link" href="#Comparing-%24I_%7Bpd%7D%24-from-the-model-to-%24I_%7Bpd%7D%24-obtained-by-convolving-%24R_%7Bpd%7D%24"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First run the SEIR model to obtain the actual $I_{pd}$:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1"># Define parameters for stochastic model</span>
<span class="n">days</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">num_E</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_I</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_R</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">beta_stoch</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>

<span class="c1"># Run 2 stochastic simulations</span>
<span class="n">results_stoch0</span> <span class="o">=</span> <span class="n">seir_model_stoch</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now obtain $h_L[j]\circledast E_{pd}[j]$:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">Ipd</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_L</span><span class="p">,</span> <span class="n">results_stoch0</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>    
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd_Actual'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd_convolved'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Ipd</span><span class="p">)),</span> <span class="n">y</span><span class="o">=</span><span class="n">Ipd</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s1">'Day'</span><span class="p">,</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s1">'Count'</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span><span class="sa">r</span><span class="s1">'$\text{Actual } I_</span><span class="si">{pd}</span><span class="s1"> \text{ vs. } h_L[j]\circledast E_</span><span class="si">{pd}</span><span class="s1">[j]$'</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span><span class="s1">'center'</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="7d33c565-9428-442c-bdf9-56e429ebf271" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("7d33c565-9428-442c-bdf9-56e429ebf271")) {
                    Plotly.newPlot(
                        '7d33c565-9428-442c-bdf9-56e429ebf271',
                        [{"name": "Ipd_Actual", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298], "y": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 2, 1, 2, 2, 1, 2, 2, 2, 3, 3, 4, 2, 11, 9, 5, 10, 10, 7, 12, 21, 21, 27, 22, 21, 26, 23, 41, 54, 58, 47, 75, 108, 83, 107, 133, 141, 163, 179, 201, 222, 284, 299, 314, 313, 361, 391, 405, 450, 424, 439, 411, 412, 437, 401, 343, 322, 301, 278, 231, 181, 194, 139, 151, 109, 102, 93, 73, 53, 46, 27, 34, 17, 19, 19, 16, 7, 6, 6, 5, 4, 3, 2, 4, 0, 2, 1, 2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"name": "Ipd_convolved", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397], "y": [-1.8189894035458565e-14, 0.0008495563537144335, 0.05296646670702103, 0.09257352340366197, 0.10539096045266888, 0.10518156295287553, 0.09833228653293191, 0.08839412186486698, 0.0774072639885162, 0.06652833485102747, 0.05637969229654118, 0.04725865131878436, 0.039267185801290905, 0.03239349530525487, 0.02656337823847025, 0.02167230110963601, 0.018454578072232834, 0.0680632059888842, 0.15703174832088507, 0.20720672370251578, 0.21883589130236603, 0.26326319011848964, 0.33785450961100166, 0.42135911608692395, 0.504752971506359, 0.6327073785962051, 0.6922267213678552, 0.9372042363379605, 1.3449718966660993, 1.7512059037621615, 2.162177895528902, 2.3667237652460695, 2.798899673625419, 3.4520865507001166, 3.9562911988035583, 4.28777035585974, 4.6743569440944235, 5.36564973336842, 5.938494775088379, 6.619758340960308, 7.574679309954381, 8.703067010386635, 10.119641393575288, 11.874767988163262, 13.540123656497563, 15.042147530934503, 17.10423667635735, 19.354638014762873, 22.552704442015674, 26.435496078768928, 30.988889036987462, 36.998280609142775, 43.223748515507275, 49.2711831556875, 55.52745241543728, 62.722198071320754, 72.70985221662492, 84.13125340488698, 96.2918994864052, 110.41456414276014, 125.20305715478361, 142.17127281331733, 160.9714789698345, 182.19627159787208, 204.1777338601961, 227.67221196764507, 253.39552093908264, 280.8420962532384, 309.2509233720038, 336.58077409501124, 362.27715581650426, 385.2388518392974, 406.87484481893654, 423.3045853558316, 432.82448513454597, 434.98063625254997, 431.6592530758312, 422.91441293751393, 408.7665712149843, 388.684564895053, 364.05351819972117, 336.5698482668816, 306.38921129848757, 274.43464784217525, 242.8692905690086, 212.8360561758248, 184.1464671634297, 157.49144671354202, 133.39749425198315, 112.18024557284713, 93.69238437214761, 77.71384412817407, 64.15712889307832, 52.70771498659389, 43.11108088616167, 35.14610334437455, 28.53381935873631, 23.122161461438505, 18.680698359041948, 15.038847846062408, 12.071591544119434, 9.665266533896515, 7.721332500196902, 6.156080516523575, 4.899329229493942, 3.892803856147865, 3.088479767920434, 2.447021024608261, 1.9363721133723557, 1.5305230919683397, 1.208447761702419, 0.9532037166323443, 0.7511780298462969, 0.5914605780287769, 0.4653271481945982, 0.3658156439754673, 0.2873803795357459, 0.22561129418464768, 0.17700675231909585, 0.13879030648515125, 0.10876334518887677, 0.08518690333009378, 0.06668708262072826, 0.0521795227843055, 0.04080919982919085, 0.031902522753534036, 0.024929276775401403, 0.019472431272353784, 0.015204219589968636, 0.01186721085573911, 0.009259348161119294, 0.007222135948992219, 0.005631320888822933, 0.004389547835830927, 0.00342057715982075, 0.002664734786935594, 0.002075335207750331, 0.0016158703512806692, 0.0012578038309320088, 0.0009788392672481164, 0.0007615625723488847, 0.0005923781701009207, 0.00046067557536261504, 0.00035817651566055265, 0.00027842449228096875, 0.00021638614409561657, 0.00016813755887375923, 0.0001306220430704562, 0.00010145796646952274, 7.87905518309297e-05, 6.117659168203319e-05, 4.7491854013142176e-05, 3.6861696502695835e-05, 2.860559086268029e-05, 2.2193879588626458e-05, 1.7216082282788797e-05, 1.3351843279219059e-05, 1.0352024610803101e-05, 8.024228971262767e-06, 6.217152415982376e-06, 4.814995459128113e-06, 3.726541722244292e-06, 2.8823719185311347e-06, 2.226882497780025e-06, 1.717913664833759e-06, 1.322777047789714e-06, 1.0159967359868461e-06, 7.782704233250115e-07, 5.937622859164548e-07, 4.5095937593941927e-07, 3.3967792091971203e-07, 2.5472620109212583e-07, 1.895682135000243e-07, 1.400157111675071e-07, 1.0187269367634145e-07, 7.323113493384881e-08, 5.184149358683499e-08, 3.644434059424384e-08, 2.513237831180959e-08, 1.6930008541748975e-08, 1.1457771620371204e-08, 7.776714596730017e-09, 5.052483373901851e-09, 3.176593423859231e-09, 2.154389662223366e-09, 1.434740504180354e-09, 9.672400480553733e-10, 6.053144296913615e-10, 3.9682392038997706e-10, 2.713096680651006e-10, 1.562413487476988e-10, 1.030053908834816e-10, 6.179938338846114e-11, 2.9926496836196746e-11, 2.3142412430843252e-11, 1.9895196601282807e-15, -9.672262990534364e-15, 1.5161205624281138e-14, 3.0886404545071854e-14, 1.4215295607300503e-14, 1.7412737918220956e-14, 3.5504932327512507e-15, 5.13877829178e-14, 1.473710042887433e-14, 8.908429549592256e-15, 7.934763956995994e-15, 2.7836621896426552e-14, 9.2148511043888e-15, 5.2291504459844875e-15, 1.0829115382193778e-14, -8.843481502651685e-15, 5.65603119895286e-15, 6.3032912223093265e-16, 8.040373922213462e-15, 2.9637403642368554e-15, 1.6902659827344734e-14, 8.4474788275557e-15, 1.448875741605349e-14, -1.5290060884076696e-14, -2.5920099400167374e-14, -6.499696614259421e-15, -9.99277049995584e-15, -4.027170957821014e-14, -3.1901963709612956e-14, -2.455169748061259e-14, -2.6602123281982415e-14, -2.4484659091883465e-14, -2.040200473840681e-14, -1.9064329108420263e-14, -2.2093141118645355e-14, -4.552050576756006e-14, -1.8456096026464586e-14, -2.3626194316922477e-14, -1.8386329785069488e-14, -4.393575238868797e-14, -1.4106417856735166e-14, -2.145798458624143e-14, -2.707073443446867e-14, -1.5407355025056498e-14, -5.814398712934016e-15, -2.2737367544323207e-14, -4.547473508864641e-15, 0.0, 0.0, -9.094947017729283e-15, 2.2737367544323207e-14, 2.2737367544323207e-14, -9.094947017729283e-15, -1.1368683772161604e-14, 2.5011104298755527e-14, 1.2505552149377763e-14, 0.0, 1.3642420526593923e-14, 2.2737367544323206e-15, 1.4779288903810084e-14, 6.252776074688882e-15, -9.094947017729283e-15, 1.2505552149377763e-14, 7.673861546209083e-15, -5.684341886080802e-15, -7.389644451905042e-15, 5.115907697472721e-15, 2.1316282072803005e-15, 6.963318810448982e-15, -3.765876499528531e-15, -4.440892098500626e-15, -8.988365607365268e-15, 6.1994853695068745e-15, 2.3461232956378807e-14, -1.7044143874045404e-14, 7.212008767965018e-15, -5.826450433232822e-15, -1.2079226507921704e-15, -2.4016344468691386e-14, 1.0196288258157438e-14, -7.105427357601002e-16, 1.1519674103510625e-14, -4.360956040727615e-15, 2.368327756130384e-14, 3.4061642395499802e-15, 1.8398615964088094e-14, -2.0319301796689616e-14, -2.950306665638891e-14, -9.052758542793527e-15, 1.610267474916327e-14, -2.612465799245456e-14, 9.68003455170674e-15, 1.3522516439934406e-14, 7.276401703393277e-15, -4.007905118896815e-15, 2.362277040646177e-14, 2.831068712794149e-17, 1.073835464993067e-14, 1.4696993622109744e-14, 1.977362718008635e-14, 2.1750864998004716e-14, -1.299495233642034e-14, -5.393810398324206e-15, -2.5637200695705076e-14, -2.864958270620832e-14, 1.1047170123124062e-14, -2.638701757096129e-14, 1.2986868525022288e-14, 1.3712069674154393e-14, -2.0923037608033822e-14, -6.827177712054322e-16, 1.5389712074154184e-14, -1.597778333251032e-14, 8.74435072961699e-16, 2.2093141118645355e-14, 2.7330611732101495e-14, 1.8456096026464586e-14, 5.436300281463913e-15, 1.964357496109237e-16, -1.063392971768773e-14, -4.0834761787233996e-15, 3.9647878621699996e-14, -2.7498947671907025e-14, -2.782539010402069e-15, -3.0565389357983116e-14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.8189894035458565e-14, -9.094947017729283e-15, 9.094947017729283e-15, 0.0, -9.094947017729283e-15, -1.8189894035458565e-14, 2.2737367544323207e-14, -3.183231456205249e-14, 0.0, -2.5011104298755527e-14, -9.094947017729283e-15, -1.3642420526593923e-14, -2.0463630789890885e-14, -1.2505552149377763e-14, -1.1368683772161603e-15, -6.8212102632969615e-15, 5.684341886080802e-16, 1.7621459846850484e-14, -2.0179413695586844e-14, 1.1937117960769683e-14, 1.3642420526593923e-14, -4.106937012693379e-14, 2.7000623958883807e-15, -2.7711166694643907e-14, -5.329070518200751e-15, -9.308109838457313e-15, -1.6200374375330286e-14, -1.9895196601282807e-15, -1.2079226507921704e-15, -7.780442956573097e-15, -5.826450433232822e-15, -6.892264536872972e-15, 2.415845301584341e-15, -8.36664071357518e-15, 8.073541835074138e-15, 9.627854069549357e-15, -1.838529328779259e-15, -2.4216184613123915e-14, -3.1352698215414423e-15, -2.531086451540432e-14, 1.588729148238599e-14, 5.007105841059456e-15, -2.0610180229141408e-14, -1.566746732351021e-14, -6.353806369929771e-15, -5.458411500569582e-15, 1.0283440765590512e-14, -1.826289119932767e-14, -2.6559310306595307e-15, 9.196809980238641e-15, -4.010819454336456e-15, -1.963179618869049e-14, -1.9046431098956874e-14, 6.32695285052165e-15, 2.128228149267386e-14, -6.031355970215202e-15, 1.492101581179739e-14, 3.176847673813654e-14, -5.041279893536199e-16, 1.5694737176552564e-14, -6.88492665656959e-15, 3.6539798964341234e-14, -2.1598469540640153e-14, 2.0923089649738103e-14, 1.627994614117334e-14, 7.194002338284378e-15, -3.878069740337331e-15, -1.1750561461354448e-14, 6.2252937180207195e-15, -1.3346527659094388e-14, 2.0241537395868093e-14, 8.548041831660247e-15]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "$\\text{Actual } I_{pd} \\text{ vs. } h_L[j]\\circledast E_{pd}[j]$", "x": 0.5, "xanchor": "center"}, "xaxis": {"title": {"text": "Day"}}, "yaxis": {"title": {"text": "Count"}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('7d33c565-9428-442c-bdf9-56e429ebf271');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-$R_{pd}$-from-the-model-to-$R_{pd}$-obtained-by-convolving-$I_{pd}$">
<a class="anchor" href="#Comparing-%24R_%7Bpd%7D%24-from-the-model-to-%24R_%7Bpd%7D%24-obtained-by-convolving-%24I_%7Bpd%7D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comparing $R_{pd}$ from the model to $R_{pd}$ obtained by convolving $I_{pd}$<a class="anchor-link" href="#Comparing-%24R_%7Bpd%7D%24-from-the-model-to-%24R_%7Bpd%7D%24-obtained-by-convolving-%24I_%7Bpd%7D%24"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use the actual $R_{pd}$ from the SEIR model above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now obtain $h_I[j]\circledast I_{pd}[j]$:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">Rpd</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_I</span><span class="p">,</span> <span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>    
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Rpd_Actual'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">6</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Rpd_convolved'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rpd</span><span class="p">)),</span> <span class="n">y</span><span class="o">=</span><span class="n">Rpd</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s1">'Day'</span><span class="p">,</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s1">'Count'</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span><span class="sa">r</span><span class="s1">'$\text{Actual } R_</span><span class="si">{pd}</span><span class="s1"> \text{ vs. } h_I[j]\circledast I_</span><span class="si">{pd}</span><span class="s1">[j]$'</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span><span class="s1">'center'</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="02fe8727-5c6f-437a-a7a8-b152905661b1" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("02fe8727-5c6f-437a-a7a8-b152905661b1")) {
                    Plotly.newPlot(
                        '02fe8727-5c6f-437a-a7a8-b152905661b1',
                        [{"name": "Rpd_Actual", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298], "y": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 4, 0, 1, 1, 0, 0, 1, 1, 2, 3, 2, 3, 5, 4, 2, 0, 9, 8, 11, 9, 11, 17, 10, 6, 24, 17, 24, 31, 35, 49, 37, 44, 61, 73, 71, 82, 96, 110, 129, 133, 138, 174, 181, 183, 216, 227, 225, 260, 284, 259, 276, 310, 280, 352, 288, 351, 331, 314, 299, 305, 261, 276, 267, 272, 252, 243, 193, 193, 183, 140, 170, 123, 122, 117, 96, 100, 76, 68, 65, 62, 40, 47, 40, 34, 29, 27, 23, 20, 19, 14, 4, 10, 3, 4, 4, 2, 6, 3, 1, 2, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"name": "Rpd_convolved", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397], "y": [0.0, 0.0, 0.0, -9.094947017729283e-15, -9.094947017729283e-15, -2.7284841053187846e-14, 0.0, 1.8189894035458565e-14, -1.8189894035458565e-14, -1.8189894035458565e-14, -1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, -1.8189894035458565e-14, -1.8189894035458565e-14, 0.0010044631988785112, 0.003932353470627277, 0.007560109764690424, 0.011580422423121491, 0.015822524023533333, 0.020151316677674915, 0.02545164096458393, 0.03253265662635386, 0.040069867359306954, 0.04866927152051176, 0.05899933065029472, 0.07063933740570065, 0.08402966646275672, 0.09963955254556822, 0.11974929671255267, 0.1444562901900281, 0.17545911612961845, 0.2122468924266741, 0.25403544140791384, 0.30195587347881886, 0.3560365196971816, 0.41701110898116894, 0.4863543266011402, 0.56518430022855, 0.6531119519376557, 0.7554707735308261, 0.8857995755277466, 1.0410567405643416, 1.21931245269731, 1.4272642155719906, 1.6629046149896625, 1.924923979531884, 2.2283708594172493, 2.590618849409982, 3.0224079550799177, 3.531240380861303, 4.109417219190579, 4.7558364801074235, 5.471208714246343, 6.26451491512368, 7.175520072491922, 8.237207167237692, 9.453006345439874, 10.831865893341446, 12.448904438054814, 14.348957368677976, 16.52704928341752, 19.04028119347453, 21.94520218479317, 25.284155149945306, 29.109801784445008, 33.471128453031255, 38.42172718602838, 44.05260044137881, 50.48156284621285, 57.75880599493705, 65.89488797315329, 74.90207444947893, 84.84295459361562, 95.74405078390757, 107.62309074460471, 120.46631450630633, 134.17115969337462, 148.6207120669042, 163.6419253882614, 179.10652202366197, 194.8706009686274, 210.66732013090726, 226.1939157867982, 241.19043985744284, 255.40949238877715, 268.5908187550216, 280.4423739611139, 290.73460664798614, 299.30471519008637, 305.99220809276403, 310.71577058424594, 313.3912641392649, 314.0135823853119, 312.6097487971967, 309.22283144521333, 303.9334286126827, 296.85779127956584, 288.1434842863165, 277.9757656765209, 266.5399707977971, 254.05435671084118, 240.74093455439316, 226.81016688044403, 212.4614067669054, 197.89461052651723, 183.29874382500734, 168.84536113839837, 154.68690001510973, 140.95516527115652, 127.76353290646057, 115.20355784063165, 103.3423026395959, 92.2322611680026, 81.90602441244278, 72.3792950660585, 63.651012795243986, 55.71035069971214, 48.53389064116638, 42.08840450607169, 36.33502204627196, 31.230150589848854, 26.727004820010677, 22.777050474834915, 19.331269505772767, 16.34122851619758, 13.759949526664181, 11.542590997234925, 9.646952745592797, 8.033822137821012, 6.667181159796057, 5.514294983051092, 4.545702649180173, 3.7351297199093763, 3.0593413692221647, 2.497952606226156, 2.0332102704687998, 1.6497592714089655, 1.334403364359028, 1.0758686571901237, 0.8645760940617713, 0.6924274123386727, 0.5526075460078007, 0.43940516644648364, 0.3480520089675631, 0.2745808201134781, 0.21570115714987118, 0.1686918531702957, 0.131308701165227, 0.1017057797713388, 0.07836881428210102, 0.06005901285242628, 0.0457659165032494, 0.03466793275427895, 0.026099370374077394, 0.019522944351006457, 0.014506866693820474, 0.01070577400848939, 0.00784486348172112, 0.005706713454412693, 0.0041203532501435805, 0.0029522204085583328, 0.0020987036897258805, 0.0014800191443055156, 0.0010352062341098644, 0.0007180633121743086, 0.0004938683776799735, 0.00033675324554224064, 0.00022761815463127278, 0.0001524901496622988, 0.0001012428440117219, 6.660776347871434e-05, 4.3418611612651146e-05, 2.803963110636687e-05, 1.793785993868369e-05, 1.1366570402060462e-05, 7.133603348847828e-06, 4.433747390066856e-06, 2.7288435921946077e-06, 1.663016832935682e-06, 1.0034385331891826e-06, 5.994156390443095e-07, 3.544675519151497e-07, 2.074938856821973e-07, 1.2022211194562261e-07, 6.894214038766222e-08, 3.912711918019341e-08, 2.197537924075732e-08, 1.2213292848173297e-08, 6.7164887695980725e-09, 3.6545907278195954e-09, 1.967428033822216e-09, 1.0478197509655728e-09, 5.520814738702029e-10, 2.877629867725773e-10, 1.483601863583317e-10, 7.564835868834052e-11, 3.816012394963764e-11, 1.9041976884182077e-11, 9.408722689840943e-12, 4.59806415165076e-12, 2.232809492852539e-12, 1.1007728062395473e-12, 5.232436706137378e-13, 2.3305801732931284e-13, 1.1027623258996755e-13, 7.51754214434186e-14, 5.044853423896712e-14, 2.3732127374387345e-14, 1.2505552149377763e-14, 3.04822833641083e-14, 3.1317171078626414e-14, 1.6679990721968353e-14, 6.465938895416912e-15, 3.289812866569264e-14, 2.899014361901209e-14, 3.126388037344441e-14, 2.685851541173179e-14, 3.062439191126032e-14, 2.0357049379526872e-14, 4.7961634663806766e-15, -6.252776074688882e-15, 2.3163693185779268e-14, 6.2705396430828846e-15, 2.1289636720212e-14, 9.521272659185343e-15, 1.3571366253017915e-14, 7.287503933639528e-15, 2.518429909059705e-14, -5.235811784132239e-15, 1.0103029524088925e-14, 2.0594637106796654e-14, 1.3478107518949401e-14, -1.099120794378905e-15, -6.539213615042172e-16, -3.4477976029734236e-15, -4.830025268631744e-15, -1.093292123499623e-14, -2.1593837828959295e-14, 2.2737367544323206e-15, 6.8212102632969615e-15, -1.1368683772161604e-14, -2.7284841053187846e-14, -2.2737367544323207e-14, -9.094947017729283e-15, -4.547473508864641e-15, -9.094947017729283e-15, 4.547473508864641e-15, -9.094947017729283e-15, -2.2737367544323207e-14, -3.637978807091713e-14, -1.3642420526593923e-14, -2.7284841053187846e-14, -1.8189894035458565e-14, -1.8189894035458565e-14, 2.2737367544323207e-14, 9.094947017729283e-15, -9.094947017729283e-15, -3.637978807091713e-14, -1.3642420526593923e-14, -2.2737367544323207e-14, -3.183231456205249e-14, -4.547473508864641e-15, 0.0, -9.094947017729283e-15, -1.3642420526593923e-14, -3.410605131648481e-14, -1.3642420526593923e-14, -3.865352482534945e-14, -2.955857780762017e-14, -3.183231456205249e-14, 0.0, -9.094947017729283e-15, -9.094947017729283e-15, -3.2969182939268646e-14, -1.4779288903810084e-14, -1.7053025658242404e-14, -1.5916157281026246e-14, -7.389644451905042e-15, -2.2737367544323206e-15, -1.7621459846850484e-14, -1.5916157281026246e-14, -2.0179413695586844e-14, -9.947598300641404e-15, -1.9326762412674726e-14, -1.4779288903810084e-14, 1.4210854715202004e-16, -1.8474111129762605e-15, -1.4352963262354024e-14, -1.7621459846850484e-14, 3.552713678800501e-16, -8.189005029635155e-15, -2.646771690706373e-15, -2.0818902157770937e-14, 2.2097879082139115e-14, -2.9842794901924207e-15, -1.4210854715202004e-14, -2.1458390619955026e-14, -7.815970093361102e-16, -1.637801005927031e-14, -7.638334409421077e-15, -1.0800249583553523e-14, 8.100187187665143e-15, -5.133671265866724e-15, -6.510347816401918e-15, -9.521272659185343e-15, -5.613287612504792e-15, -5.013767179207207e-15, -1.836308882730009e-14, -1.0680345496894006e-14, 1.0360601265801962e-14, -1.3773426843499692e-14, -3.1668001554407966e-14, -1.709077324107966e-14, -1.753597267395435e-14, -1.474209643248514e-14, -2.7002289293420745e-14, 2.0027868252725513e-14, -2.3880897259687117e-14, 9.094947017729283e-15, 1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, 0.0, 0.0, 0.0, 1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, 0.0, 0.0, 1.8189894035458565e-14, 1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, 3.637978807091713e-14, 3.637978807091713e-14, 5.456968210637569e-14, 0.0, 0.0, 5.456968210637569e-14, -1.8189894035458565e-14, 0.0, 0.0, 3.637978807091713e-14, 0.0, 0.0, 1.8189894035458565e-14, 0.0, -9.094947017729283e-15, -3.637978807091713e-14, 1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, -9.094947017729283e-15, 9.094947017729283e-15, 1.8189894035458565e-14, -9.094947017729283e-15, 4.547473508864641e-15, 9.094947017729283e-15, 9.094947017729283e-15, 0.0, 0.0, 0.0, 9.094947017729283e-15, -1.8189894035458565e-14, 5.684341886080802e-15, 1.3642420526593923e-14, 6.8212102632969615e-15, -9.094947017729283e-15, -7.958078640513123e-15, 1.1368683772161604e-14, 1.9895196601282807e-14, -2.842170943040401e-15, 9.094947017729283e-15, 1.2647660696529783e-14, 1.1368683772161604e-14, 1.7053025658242404e-15, -1.8474111129762605e-15, 1.4992451724538113e-14, 4.121147867408581e-15, 1.1297629498585594e-14, 2.476241434123949e-14, 7.105427357601002e-17, 4.7606363295926715e-15, -1.7053025658242404e-15, 1.6697754290362355e-14, 2.913225216616411e-15, 1.2638778912332782e-14, -6.448175327022909e-15, 1.552091788425969e-14, 8.260059303211165e-15, 1.0693668173189509e-14, -5.599964936209289e-15, 2.6785240692106526e-14, 2.239763929878791e-14, -1.807443084089755e-15]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "$\\text{Actual } R_{pd} \\text{ vs. } h_I[j]\\circledast I_{pd}[j]$", "x": 0.5, "xanchor": "center"}, "xaxis": {"title": {"text": "Day"}}, "yaxis": {"title": {"text": "Count"}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('02fe8727-5c6f-437a-a7a8-b152905661b1');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="De-convolution">
<a class="anchor" href="#De-convolution" aria-hidden="true"><span class="octicon octicon-link"></span></a>De-convolution<a class="anchor-link" href="#De-convolution"> </a>
</h2>
<p>We get very close matches when convlving, can we obtain similar results by deconvolving?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Problems-with-de-convolution">
<a class="anchor" href="#Problems-with-de-convolution" aria-hidden="true"><span class="octicon octicon-link"></span></a>Problems with de-convolution<a class="anchor-link" href="#Problems-with-de-convolution"> </a>
</h3>
<p><strong>Illl-posed</strong></p>
<p>Unfortunately de-convolution is not as straightforward as the convolution.</p>
<p>A quick recap of the math, in the frequency domain we have (Fourier or z transform)

$$F \{ f âˆ— g \} = F \{ f \} ~ F \{ g \}$$

And so if we have:

$$y=\ f âˆ— g$$

Then:

$$F \{ y \} = F \{ f \} ~ F \{ g \}$$

And:

$$g = F^{-1} \left(\frac{F\{y\}}{F\{f\}} \right) $$
</p>
<p>But this last equation is often ill-posed.</p>
<p><strong>Noise in data</strong></p>
<p>We can see above that daily new data varies a lot from day to day due to the stochasticity of the model. This results in high-frequency decomposition in the frequency domain.</p>
<p><strong>Initial conditions and boundary-value problems</strong></p>
<p>Boundary values refer to the values on day 0 and the last day we have data for. Due to the way data is reported on JHU, we someimes have crayz values here, most commonly a value of 0 for the latest day if the data isn0t reported on time for example. These gaps can create issues for deconvolution.</p>
<p>In the next blog post I go around this by simplz averaging the last 3 days instead of using only the last day.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Solutions-to-these-problems">
<a class="anchor" href="#Solutions-to-these-problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Solutions to these problems<a class="anchor-link" href="#Solutions-to-these-problems"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Iterative-deconvoluton">
<a class="anchor" href="#Iterative-deconvoluton" aria-hidden="true"><span class="octicon octicon-link"></span></a>Iterative deconvoluton<a class="anchor-link" href="#Iterative-deconvoluton"> </a>
</h4>
<p>Multiple iterative deconvolution algorithms exist: Lucy_Richardson, Gold, or Van Cittert among others.</p>
<p>LR has already been used to get daily incidence of the Spanish flu based on death records in Philadelphia at the time for example <a href="https://doi.org/10.1073/pnas.0902958106">1</a>.</p>
<p>An adaptation of those above is used here with the basics below (see code for details):</p>
<p>Let's use the equation for $I_{pd}$ as an example:

$$I_{pd}[j] = \sum_{n_L=0}^{M_L-1}h_L[n_L]~E_{pd}[j-n_L]= h_L[j]\circledast E_{pd}[j]$$
</p>
<p>The idea is that after an initial guess for $E_{pd}$ we can iteraively find a better one.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the $n^{th}$ guess for $E_{pd}$ written as $E_{pd, n}$  we have:

$$I_{pd}[j]= h_L[j]\circledast E_{pd, n}[j]$$


$$\leftrightarrow 0 = I_{pd}[j] - h_L[j]\circledast E_{pd, n}[j]$$


$$\leftrightarrow E_{pd,n+1} = E_{pd,n} + I_{pd}[j] - h_L[j]\circledast E_{pd, n}[j]$$
</p>
<p>Where $O[j] = I_{pd}[j] - h_L[j]\circledast E_{pd, n}[j]$ is the error term.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hence we want to minimze O[j].</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Initial guess</strong></p>
<p>We know our $h_L$ and $h_I$ are in part simply delay functions, so an initial first guess is to simply use the same signal delayed by the time difference caused by the impulse response.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Low-pass-filter">
<a class="anchor" href="#Low-pass-filter" aria-hidden="true"><span class="octicon octicon-link"></span></a>Low-pass filter<a class="anchor-link" href="#Low-pass-filter"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To go around those high-frequency notes in the data, we can siply use a lowpass filter implemented as a butterworth filter below:</p>
<p>The basic effect is that it smoothes the daily values as we have when convolving from the previous state daily values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">lowpass</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
  <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Sampling frequency</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1">#select number of days done in SEIR model</span>
  <span class="n">signala</span> <span class="o">=</span> <span class="n">x</span>

  <span class="c1">#fc = 0.05  # Cut-off frequency of the filter</span>
  <span class="n">w</span> <span class="o">=</span> <span class="n">fc</span> <span class="o">/</span> <span class="p">(</span><span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Normalize the frequency</span>
  <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s1">'low'</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">signala</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deconvolution-in-practice">
<a class="anchor" href="#Deconvolution-in-practice" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deconvolution in practice<a class="anchor-link" href="#Deconvolution-in-practice"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Coding-the-iterative-deconvolution">
<a class="anchor" href="#Coding-the-iterative-deconvolution" aria-hidden="true"><span class="octicon octicon-link"></span></a>Coding the iterative deconvolution<a class="anchor-link" href="#Coding-the-iterative-deconvolution"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="c1"># Let's define an iteration function:</span>
<span class="k">def</span> <span class="nf">iter_deconv</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">impulse_response</span><span class="p">,</span> <span class="n">input_signal</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">comparator</span><span class="p">):</span>
  <span class="n">conv</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">impulse_response</span><span class="p">,</span> <span class="n">input_signal</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)</span>
  <span class="n">correction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">comparator</span><span class="o">-</span><span class="n">conv</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">comparator</span><span class="p">)],</span> <span class="n">delay</span><span class="p">)</span>
  <span class="n">input_signal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">lowpass</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">correction</span><span class="o">+</span><span class="n">input_signal</span><span class="p">))</span>
  <span class="n">input_signal</span><span class="p">[</span><span class="n">input_signal</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
  <span class="k">return</span> <span class="n">input_signal</span>

<span class="c1"># Define a function to return MSE between two signals as a measure of goodness of fit</span>
<span class="k">def</span> <span class="nf">msecalc</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-$E_{pd}$-from-the-model-to-$E_{pd}$-obtained-by-de-convolving-$I_{pd}$">
<a class="anchor" href="#Comparing-%24E_%7Bpd%7D%24-from-the-model-to-%24E_%7Bpd%7D%24-obtained-by-de-convolving-%24I_%7Bpd%7D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comparing $E_{pd}$ from the model to $E_{pd}$ obtained by de-convolving $I_{pd}$<a class="anchor-link" href="#Comparing-%24E_%7Bpd%7D%24-from-the-model-to-%24E_%7Bpd%7D%24-obtained-by-de-convolving-%24I_%7Bpd%7D%24"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="c1">#regularization parameter</span>
<span class="n">alpha</span><span class="o">=</span><span class="mi">2</span>

<span class="c1"># Setup up the resultant Ipd we want to compare our guess with</span>
<span class="n">Ipd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
<span class="n">Ipd</span><span class="p">[</span><span class="n">Ipd</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># Find delay caused by h_L</span>
<span class="n">delay</span><span class="o">=</span><span class="n">Ipd</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="o">-</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">Ipd</span><span class="p">,</span> <span class="n">h_L</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>

<span class="c1"># We want initial guess to simply be the result of the convolution delayed</span>
<span class="n">initial_guess</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">Ipd</span><span class="p">,</span><span class="n">delay</span><span class="p">)</span>
<span class="n">Enext</span> <span class="o">=</span> <span class="n">initial_guess</span>

<span class="c1"># AN array to record MSE between result we want and our iterated guess</span>
<span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="n">msecalc</span><span class="p">(</span><span class="n">Ipd</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_L</span><span class="p">,</span> <span class="n">Enext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">Ipd</span><span class="p">)]))</span>

<span class="n">itercount</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">mse</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mse</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
  <span class="n">itercount</span><span class="o">=</span><span class="n">itercount</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">Enext</span><span class="o">=</span><span class="n">iter_deconv</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">h_L</span><span class="p">,</span> <span class="n">Enext</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">Ipd</span><span class="p">)</span>
  <span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="n">msecalc</span><span class="p">(</span><span class="n">Ipd</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_L</span><span class="p">,</span> <span class="n">Enext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">Ipd</span><span class="p">)]))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Iteration #"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itercount</span><span class="p">)</span> <span class="o">+</span><span class="s2">": MSE= "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mse</span><span class="p">[</span><span class="n">itercount</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Iteration #"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itercount</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span><span class="s2">": MSE= "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mse</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" so we use the result of the previous iteration."</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration #1: MSE= 128.253113864647
Iteration #2: MSE= 29.12630153955291
Iteration #3: MSE= 20.66117839168287
Iteration #4: MSE= 14.827667889972124
Iteration #5: MSE= 11.903142433438639
Iteration #6: MSE= 9.752160210380993
Iteration #7: MSE= 7.427715483375404
Iteration #8: MSE= 6.485147598975144
Iteration #9: MSE= 4.774163310379314
Iteration #10: MSE= 4.219980970725028
Iteration #11: MSE= 3.2288913917683457
Iteration #12: MSE= 2.9803815164048726
Iteration #13: MSE= 2.384262857175685
Iteration #14: MSE= 2.239378745592882
Iteration #15: MSE= 1.8410465823606756
Iteration #16: MSE= 1.858781105754766 so we use the result of the previous iteration.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>    
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'E_pd'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Epd=lowpass(E_pd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Epd=deconv(I_pd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">Enext</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_pd'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd=lowpass(I_pd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">])),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd=conv(E_pd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_L</span><span class="p">,</span> <span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd=conv(deconv(Ipd))'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_L</span><span class="p">,</span> <span class="n">Enext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">Ipd</span><span class="p">)])</span>
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    
    <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s1">'Day'</span><span class="p">,</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s1">'Count'</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span><span class="sa">r</span><span class="s1">'$\text{Actual } E_</span><span class="si">{pd}</span><span class="s1"> \text{ vs. deconvolution of } I_</span><span class="si">{pd}</span><span class="s1">$'</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span><span class="s1">'center'</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="4c6c68c5-fa04-4ce1-bfbd-c6bf5dee01c1" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("4c6c68c5-fa04-4ce1-bfbd-c6bf5dee01c1")) {
                    Plotly.newPlot(
                        '4c6c68c5-fa04-4ce1-bfbd-c6bf5dee01c1',
                        [{"name": "E_pd", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 2, 0, 5, 5, 4, 5, 1, 9, 9, 5, 5, 8, 13, 7, 13, 16, 17, 22, 26, 22, 23, 37, 33, 54, 55, 66, 90, 80, 86, 97, 117, 165, 163, 179, 220, 218, 274, 291, 340, 342, 392, 434, 466, 494, 492, 508, 499, 535, 465, 429, 378, 365, 315, 271, 206, 172, 141, 92, 61, 54, 41, 17, 13, 8, 8, 4, 2, 3, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"name": "Epd=lowpass(E_pd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [1.1119945158493356, 0.9051988514557653, 0.6954507678823532, 0.48955050635159947, 0.29408155671405917, 0.11520830032040844, -0.04142981094857468, -0.17074426440707904, -0.26817711047392917, -0.32967688170867193, -0.35171385710721753, -0.3313692820348501, -0.2665172402469318, -0.1560967608860776, -0.0004482860033640049, 0.19833412297312386, 0.436102577266685, 0.7064876863274641, 1.0009477683855394, 1.3091113754708277, 1.6194677028232343, 1.9204233472191417, 2.201695982638007, 2.455960700962207, 2.680609391097443, 2.879435044395666, 3.0640197734231247, 3.254596525489155, 3.4801771347418904, 3.7777958691424023, 4.190804074595397, 4.766259510694134, 5.551573909661732, 6.5907040673586135, 7.920282562065063, 9.5661678848385, 11.540934977217113, 13.84281595476236, 16.45653320369777, 19.356343201567867, 22.511433164406245, 25.893592200921024, 29.48682572984224, 33.298309600785096, 37.36980350933258, 41.78838287812601, 46.69513719081887, 52.2903661525887, 58.833832391105865, 66.6388395370977, 76.05931179132487, 87.46963631374092, 101.23773830619616, 117.69260992215202, 137.0882242922287, 159.56637163127925, 185.12141656406013, 213.5702594484013, 244.53083780001023, 277.41226351749066, 311.4191109803655, 345.57144770281184, 378.74098274717187, 409.70229230980163, 437.1965925836268, 460.00411833127356, 477.0200018786266, 487.3277998253478, 490.264612290925, 485.4721385205704, 472.9289922255264, 452.96107731872377, 426.22866691915203, 393.6908513469853, 356.5499961238964, 316.18054791206146, 274.0477698501871, 231.62268771879735, 190.2996625385379, 151.32258963885232, 115.7248062549453, 84.28645842727754, 57.51146648730944, 35.62449997827703, 18.586701741894768, 6.127452062064129, -2.2116311129226705, -7.024921967760355, -8.987919732893772, -8.803734495615823, -7.154784446836094, -4.662696475993115, -1.8583720249243234, 0.8368968075709535, 3.119393274201681, 4.801028069014561, 5.7991473537409135, 6.120195116059565, 5.839514882399022, 5.079539144975512, 3.988391345267229, 2.7205630591877865, 1.420881757462432, 0.21250518531543136, -0.8107855749031742, -1.588132666077725, -2.0914555755154662, -2.322314184480675, -2.3066150693601366, -2.0880331536283503, -1.72097627361919, -1.2638113343163788, -0.7729180946501691, -0.2979611878903423, 0.12140786944278649, 0.4573728471472027, 0.6943939183395379, 0.8284697725684901, 0.8654930664790359, 0.8190051099236785, 0.707655971974148, 0.5526490245665417, 0.37540156315148354, 0.19559332844891217, 0.029710024323624826, -0.10987407067918, -0.2152862377538541, -0.28307514793110666, -0.3137494792160787, -0.31104297655879604, -0.2810193083389116, -0.2311246407305117, -0.16928171667071032, -0.10309917105689477, -0.039246663806423346, 0.016977223280992392, 0.061879303879502585, 0.09342184780313448, 0.11111602225968926, 0.1157955299547211, 0.10931154910384952, 0.09418994826722352, 0.07328797835675914, 0.04948120642532973, 0.02540339118792378, 0.0032533129342279346, -0.015325854590026828, -0.029296498480563576, -0.03821370441985607, -0.042161678151515045, -0.04165397311918572, -0.0375127489908311, -0.030741505272301496, -0.022403799130970726, -0.013517741082954183, -0.004972945028222749, 0.002526561192902247, 0.008492889457059682, 0.012660205318248914, 0.014969769450621407, 0.015539082035864333, 0.014620658618079038, 0.012555928597040925, 0.009729226032831668, 0.00652596779241724, 0.0032980260000607144, 0.000338134689568064, -0.002135957449123051, -0.003987871300873566, -0.005160597818457931, -0.005667755028243222, -0.005580058404694121, -0.0050090480265360116, -0.004090004806246177, -0.002965723677066921, -0.0017724442771570798, -0.0006288201582529847, 0.0003716175537771672, 0.0011644378481497852, 0.0017149938429657126, 0.0020163262083102754, 0.002084958092528369, 0.0019553248792212635, 0.0016735744980412544, 0.0012914019935276442, 0.0008604632879413922, 0.00042776631887259824, 3.228098264377006e-05, -0.0002971416811014207, -0.0005425833807737986, -0.000696753685170881, -0.000761788642650066, -0.0007474165463146669, -0.0006687650710115911, -0.0005440682456641333, -0.00039249561526204615, -0.0002322762644098143, -7.92339243285269e-05, 5.420760849768898e-05, 0.00015954186381966542, 0.00023225685917566106, 0.00027154188446091887, 0.00027971467943603773, 0.0002614689337971595, 0.00022304067312179466, 0.00017138215882695818, 0.00011341580784023893, 5.5420847258377756e-05, 2.5843686738786264e-06, -4.1271763257074824e-05, -7.37944037175567e-05, -9.405334159539443e-05, -0.00010237635013148618, -0.00010010058767187108, -8.92771450985565e-05, -7.23633081162394e-05, -5.1932173844789154e-05, -3.042254327720825e-05, -9.94441629720113e-06, 7.852224368109175e-06, 2.184464903634646e-05, 3.1445782987538116e-05, 3.656328051000662e-05, 3.752152758489548e-05, 3.496000546420439e-05, 2.972121793688072e-05, 2.2740015892668582e-05, 1.4943964921094075e-05, 7.17173334538388e-06, 1.1365147805069208e-07, -5.724111840379223e-06, -1.0032671765781461e-05, -1.2693634061118666e-05, -1.3756464862764576e-05, -1.340480663723477e-05, -1.19166772172309e-05, -9.623174705098935e-06, -6.8696386234304e-06, -3.982309524905677e-06, -1.2425075965117718e-06, 1.1306733130424504e-06, 2.9890944176415574e-06, 4.2564388384448525e-06, 4.922509717684853e-06, 5.032614254472521e-06, 4.67383894617069e-06, 3.959984379214639e-06, 3.016739403997809e-06, 1.968377717570245e-06, 9.269001674790987e-07, -1.583341263937791e-08, -7.928009594383957e-07, -1.363476740241457e-06, -1.7128331840806105e-06, -1.8482383396983382e-06, -1.7948930590251548e-06, -1.5904701997972114e-06, -1.2795739848330436e-06, -9.08545963329278e-07, -5.210212713785032e-07, -1.545014667593902e-07, 1.6192704579542638e-07, 4.0872484202279637e-07, 5.759808661530672e-07, 6.62619242098412e-07, 6.749548653862048e-07, 6.248403904322028e-07, 5.276414482115175e-07, 4.0025099366872463e-07, 2.593134208952993e-07, 1.197805914318466e-07, -6.129035495472517e-09, -1.095454199842898e-07, -1.851553851815914e-07, -2.3105675078523757e-07, -2.4833298523086283e-07, -2.404351519720065e-07, -2.1246003442323738e-07, -1.7040712035839315e-07, -1.2048461115173245e-07, -6.851801069593379e-08, -1.9496339459562e-08, 2.2727405325945255e-08, 5.558163076170517e-08, 7.778125584825469e-08, 8.921659040367197e-08, 9.075627497852184e-08, 8.399702130431389e-08, 7.099198508708641e-08, 5.3985998102958175e-08, 3.5180370883978665e-08, 1.6543371399265395e-08, -3.24434661393797e-10, -1.4267359024680684e-08, -2.4597338987661037e-08, -3.1069756932919694e-08, -3.382284243346374e-08, -3.3292722203611034e-08, -3.011638027833977e-08]}, {"name": "Epd=deconv(I_pd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 2.0, 3.0, 5.0, 7.0, 9.0, 11.0, 14.0, 16.0, 19.0, 21.0, 24.0, 26.0, 29.0, 31.0, 34.0, 37.0, 40.0, 45.0, 51.0, 59.0, 70.0, 83.0, 99.0, 118.0, 140.0, 166.0, 194.0, 225.0, 258.0, 292.0, 326.0, 359.0, 391.0, 419.0, 444.0, 463.0, 476.0, 483.0, 483.0, 476.0, 463.0, 442.0, 416.0, 385.0, 350.0, 312.0, 273.0, 233.0, 194.0, 157.0, 122.0, 91.0, 64.0, 42.0, 24.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 5.0, 5.0, 5.0, 4.0, 3.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"name": "I_pd", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 2, 1, 2, 2, 1, 2, 2, 2, 3, 3, 4, 2, 11, 9, 5, 10, 10, 7, 12, 21, 21, 27, 22, 21, 26, 23, 41, 54, 58, 47, 75, 108, 83, 107, 133, 141, 163, 179, 201, 222, 284, 299, 314, 313, 361, 391, 405, 450, 424, 439, 411, 412, 437, 401, 343, 322, 301, 278, 231, 181, 194, 139, 151, 109, 102, 93, 73, 53, 46, 27, 34, 17, 19, 19, 16, 7, 6, 6, 5, 4, 3, 2, 4, 0, 2, 1, 2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"name": "Ipd=lowpass(I_pd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0.022791818372247682, 0.028350606202941355, 0.032198648058805165, 0.0343631988814043, 0.03491767796763867, 0.03400490792675115, 0.03187413711900923, 0.02892723394906289, 0.025766782130384577, 0.02323675558692251, 0.022445341412394838, 0.024759624390758916, 0.03176354004480663, 0.045174006852189495, 0.06671562287946041, 0.09796157973173207, 0.1401566275936618, 0.19404533767416643, 0.25973361112103516, 0.3366120803414963, 0.4233665808327322, 0.5180939154935621, 0.6185315071398791, 0.7223978232612823, 0.8278272457747763, 0.9338693760240668, 1.0410102093281144, 1.15166317121478, 1.270573768459888, 1.4050842549502078, 1.5652147707936406, 1.763533750138467, 2.0148104906181543, 2.33546372171832, 2.742839567463819, 3.254369408078296, 3.8866727030890025, 4.65468224748593, 5.570880293998659, 6.64474452612425, 7.882513793040441, 9.287393200939578, 10.86032031934752, 12.601399154328504, 14.51206820760568, 16.598002638978773, 18.87266667298957, 21.36134592178782, 24.105414705694336, 27.166535715583926, 30.63044015747944, 34.60988099665811, 39.246282912034104, 44.709542698220424, 51.19539658199237, 58.9198078606327, 68.1099691967038, 78.9917639394939, 91.77387375454623, 106.62912738753627, 123.6741173909161, 142.94851226659935, 164.3957978605799, 187.84734098812095, 213.0116454922335, 239.47045009988992, 266.68290488412146, 293.9984945409002, 320.6787130241559, 345.92680003894355, 368.9241697834924, 388.87152069534847, 405.03204675247895, 416.7737476979975, 423.6076526126627, 425.21890182759074, 421.48808803966466, 412.5009841869795, 398.5456915023538, 380.09723604303866, 357.79065420675306, 332.38456688816603, 304.71805377711405, 275.6641936167074, 246.08384920476416, 216.7831231499446, 188.4774219970174, 161.7643065397369, 137.10636716466422, 114.82436505813304, 95.09995407841724, 77.98655497557966, 63.42646139135073, 51.272035532770914, 41.30887776569511, 33.27907300676093, 26.90295508961961, 21.898219134531438, 17.995601523909947, 14.95070996856791, 12.551910521363196, 10.624459028703154, 9.031295910244864, 7.671096270790743, 6.474271850441063, 5.3976525620216975, 4.418539496607709, 3.5287335010409024, 2.729022134841365, 2.0244702096478377, 1.4207198584958163, 0.9213770040391663, 0.5264509822807518, 0.23172877135295283, 0.028907852401891886, -0.0937176364090434, -0.15022683755671515, -0.1558912428954463, -0.1260052680367721, -0.07485204303061045, -0.014887190066768698, 0.04381548821188712, 0.09384645386587703, 0.13048859806598365, 0.1515290823168609, 0.15690585505147545, 0.1482459045620166, 0.12835219312933072, 0.10069106510001662, 0.06892308644169627, 0.03650918008885048, 0.006411939637466165, -0.01909965810338965, -0.03854429260851626, -0.051231632967881635, -0.05719152059083545, -0.05704907477756995, -0.051866938868128466, -0.042974965815141264, -0.031805099421915395, -0.019745548086475738, -0.008024089646857947, 0.002374030047052791, 0.01075222794162442, 0.01671485131076459, 0.020150368421420876, 0.021192045973562175, 0.020163552678242998, 0.01751698298657981, 0.013770167987279694, 0.009449007588531014, 0.005039109358178232, 0.0009494397775747001, -0.0025108525646616287, -0.00514266261687815, -0.006855543979049553, -0.0076568588076604376, -0.007634080371066094, -0.006933022191948877, -0.005734648565471181, -0.004232785518698796, -0.0026145667575557794, -0.001044885089308824, 0.00034445950051969847, 0.0014607640578126327, 0.002251887583618595, 0.00270383694176786, 0.002835365537346106, 0.0026905880291960096, 0.0023306167371926222, 0.0018251375234689126, 0.0012446883560125847, 0.0006542079402544491, 0.00010820941854497107, -0.00035227294599287387, -0.00070100038608024, -0.0009262946810118393, -0.0010295431338651177, -0.00102279673968881, -0.0009258342477442087, -0.0007630475688810364, -0.0005604579743146603, -0.00034310689759083524, -0.0001329891740929623, 5.238117599364774e-05, 0.00020075474423955416, 0.00030532346723086487, 0.00036438033847498624, 0.00038058264123931395, 0.00035995365671987064, 0.0003107576427813076, 0.0002423707025960607, 0.0001642491527526764, 8.507057416206866e-05, 1.2094191945545278e-05, -4.9240499641295496e-05, -9.548253719683975e-05, -0.00012513117616646353, -0.00013842999718385038, -0.0001370410437200401, -0.0001236490230991847, -0.0001015431297192216, -7.421775767357186e-05, -4.5024487779199364e-05, -1.6897506564473566e-05, 7.835809548157072e-06, 2.7557067035205566e-05, 4.1377865000020505e-05, 4.9091914119876136e-05, 5.1074553297196226e-05, 4.8147813086286314e-05, 4.142908948780609e-05, 3.2179807064707577e-05, 2.1667595855563113e-05, 1.1051941248728005e-05, 1.2994323336503763e-06, -6.868978402695035e-06, -1.2999572168764068e-05, -1.6899817321154443e-05, -1.8610038728791597e-05, -1.8359219421544422e-05, -1.651165014500224e-05, -1.351078945199987e-05, -9.825836980252336e-06, -5.905320823584211e-06, -2.1406233636074755e-06, 1.1590279371295482e-06, 3.7798688473546537e-06, 5.606056509302277e-06, 6.6129493345149345e-06, 6.8534092179094535e-06, 6.439566484960943e-06, 5.522467960862454e-06, 4.271795743388675e-06, 2.857456570541679e-06, 1.4343607434152412e-06, 1.3119462236303576e-07, -9.56506297712326e-07, -1.7691145249456463e-06, -2.281978500344949e-06, -2.5015277644812583e-06, -2.4592798968723485e-06, -2.204650530875938e-06, -1.7974175686994118e-06, -1.3005732389626106e-06, -7.741350840812409e-07, -2.70301719364094e-07, 1.698482217041498e-07, 5.180880231401347e-07, 7.593244996499561e-07, 8.906569670309595e-07, 9.195108064169133e-07, 8.611737303516234e-07, 7.360590301251901e-07, 5.669879467431698e-07, 3.7673066895033894e-07, 1.859805984922149e-07, 1.1867362099641299e-08, -1.329524795388783e-07, -2.406464874001206e-07, -3.080651161495387e-07, -3.3620664710478616e-07, -3.294047586189277e-07, -2.943596910342068e-07, -2.391268545291824e-07, -1.7216068515411335e-07, -1.0148956781382038e-07, -3.40727153355648e-08, 2.463523955046863e-08, 7.090923660559736e-08, 1.0278494034807023e-07, 1.1992706544660004e-07, 1.2337503916248934e-07, 1.1521013175979579e-07, 9.818751753815734e-08, 7.537229245746458e-08, 4.98113216068392e-08, 2.4264032672680415e-08, 1.0059714449540587e-09, -1.8289982606313563e-08, -3.259764845839737e-08, -4.1515920823894476e-08, -4.5194891396519956e-08, -4.4225469244183956e-08, -3.950879349974155e-08, -3.212071754416248e-08, -2.3184436472574803e-08, -1.3761331380214983e-08, -4.766718258420323e-09, 3.086215687822377e-09, 9.314122993927427e-09, 1.3665290117662473e-08, 1.6099891632652148e-08, 1.6754300022863208e-08, 1.5895555621631854e-08, 1.3871972546738257e-08, 1.1065205888501855e-08, 7.848074874385862e-09, 4.551177971528856e-09]}, {"name": "Ipd=conv(E_pd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [-3.637978807091713e-14, 0.0009447020062543743, 0.05966743793778733, 0.15147725978520613, 0.2382430877902516, 0.3029210249153857, 0.3388431698929162, 0.34533799387205366, 0.32528699063158456, 0.2836275062057439, 0.22639991141765678, 0.16013264258464005, 0.09144305011827555, 0.026774139510148415, -0.02778910757498352, -0.06666484167772296, -0.08490988887242452, -0.0783635565486793, -0.043806153919567804, 0.020872987723845996, 0.11651462139194223, 0.24256257755911123, 0.39700490639805824, 0.5764208185605179, 0.7761690216671909, 0.990744698848161, 1.214317575151802, 1.4414429808837965, 1.6679132215503547, 1.89169055843021, 2.11383918979211, 2.339355729560723, 2.5777895229449177, 2.843548571053225, 3.1558054458256564, 3.5379505123144286, 4.016585602642026, 4.6201067991248275, 5.376985219263638, 6.313913355763391, 7.454034689433793, 8.815509127675131, 10.410680195581863, 12.246096954119157, 14.323601193991564, 16.64261737950054, 19.20368000659681, 22.013103771330606, 25.088552569513467, 28.465104285428197, 32.201254696426346, 36.38417493601664, 41.13345432296868, 46.602544342309876, 52.977185373418365, 60.47025186389948, 69.31268993595268, 79.74053000631613, 91.9783148946257, 106.21966533039573, 122.60607993156046, 141.2054015238357, 161.99163866485927, 184.82797298442594, 209.45477715102177, 235.4842931875708, 262.40326974126197, 289.5843411139399, 316.3062816118417, 341.7825369573821, 365.1966870706152, 385.74280714824, 402.6681414961791, 415.3151517482035, 423.15989486605775, 425.8438495316476, 423.1967362621299, 415.2485307285987, 402.22968939187405, 384.5595131097785, 362.82348332261273, 337.74123529715524, 310.1275118615543, 280.8489124126023, 250.77947905191414, 220.7581313048632, 191.55068451857397, 163.81869963949066, 138.0967677955172, 114.7790986266697, 94.11552772891872, 76.21635363092446, 61.06481626372129, 48.5355799980122, 38.41731029409043, 30.437340372618092, 24.28650207262578, 19.642417686331523, 16.18988118793515, 13.637356460401657, 11.72904452548733, 10.25238227656045, 9.041199123613648, 7.975051195608826, 6.975460815973136, 5.999906937869291, 5.034443757709757, 4.085780451657788, 3.173550478258004, 2.323352519563101, 1.5609759608700622, 0.9080498101484403, 0.3791906036400819, -0.019415853274039576, -0.2901740348096759, -0.4432298442399916, -0.49490370116538607, -0.4657035021640843, -0.37819563630503356, -0.2549717051715382, -0.11689453000811023, 0.018253413270942546, 0.13665634357906234, 0.22887846631560468, 0.28984199740477157, 0.3184416371568201, 0.3168885002048515, 0.28988551192745243, 0.24373438502290368, 0.18546360256558772, 0.12204987776076638, 0.05978497238867684, 0.0038180320651286614, -0.042117104746478666, -0.07579815869736554, -0.09645689181998711, -0.10460016678711345, -0.10174705477818165, -0.0901203659707798, -0.07232830757444159, -0.05106659143963361, -0.028864168087877007, -0.007887800223523502, 0.010187240788264154, 0.02424026593226057, 0.033707902102902185, 0.03853670584408422, 0.03909859666909087, 0.036083122329515216, 0.030380200976287883, 0.022965461517312182, 0.014797961542010435, 0.006737254026486542, -0.0005161680153059257, -0.006455809379203195, -0.010780667858256755, -0.013386350406616808, -0.01434015990440124, -0.013845175474594696, -0.01219845656515197, -0.00974813128544156, -0.006853398937278143, -0.0038505134750630534, -0.0010267453724191, 0.001396741910698438, 0.0032731245526338173, 0.0045300741749838384, 0.005163230760297211, 0.005224740798064432, 0.004808744999445481, 0.004035644012773219, 0.0030367610258713283, 0.0019407024657118654, 0.0008623394404190777, -0.00010506244593216253, -0.0008944105723094253, -0.0014662177506502873, -0.0018073182159815816, -0.0019274554780542986, -0.0018544179457606446, -0.0016284101612411917, -0.001296295865669066, -0.0009062496539399945, -0.0005032238890784413, -0.00012549380218210615, 0.000197598474915921, 0.00044670837787755605, 0.0006124744830422557, 0.0006946145629117951, 0.0007003679686517864, 0.0006425374773479753, 0.0005373753999704789, 0.00040252998654120023, 0.00025522511296345194, 0.00011079523418358051, -1.8355425039171536e-05, -0.00012335039968892404, -0.00019901912270153588, -0.00024371286866895048, -0.00025883809295951466, -0.00024819813277364043, -0.00021723550087428658, -0.00017225980673634124, -0.0001197327997013975, -6.56644599949896e-05, -1.5154739961742436e-05, 2.790348879468496e-05, 6.096184368951541e-05, 8.280974817148845e-05, 9.344937496257089e-05, 9.388402677767971e-05, 8.585395437276988e-05, 7.155238141988318e-05, 5.3350560862748255e-05, 3.35548565546473e-05, 1.4211971866071593e-05, -3.0286642290766608e-06, -1.6993021830273847e-05, -2.7004495884828118e-05, -3.285764502898303e-05, -3.4754408239081604e-05, -3.321503971953632e-05, -2.8976128337662998e-05, -2.2887065469551217e-05, -1.5814482470932754e-05, -8.561808097925505e-06, -1.8084968866072249e-06, 3.929069930830309e-06, 8.315295946306201e-06, 1.119383922501771e-05, 1.257033178464817e-05, 1.2583638843018385e-05, 1.1470222774941086e-05, 9.526000008002987e-06, 7.069534345214845e-06, 4.409623883709912e-06, 1.8194107899560664e-06, -4.818088028407663e-07, -2.3387926541124095e-06, -3.6630572987139675e-06, -4.429145692483872e-06, -4.6659144072691565e-06, -4.444486385182245e-06, -3.864526916004252e-06, -3.0403627397390665e-06, -2.0882098397123627e-06, -1.1154601611451653e-06, -2.126237200172909e-07, 5.51815644485032e-07, 1.1336795796523803e-06, 1.5128054371871257e-06, 1.6906612268030585e-06, 1.6864432006968854e-06, 1.532270171651362e-06, 1.268060379970848e-06, 9.366052427139948e-07, 5.79244595826367e-07, 2.3242597478656536e-07, -7.469908837265393e-08, -3.216080713741576e-07, -4.967368040809106e-07, -5.969508190162287e-07, -6.263559362196247e-07, -5.946690937719268e-07, -5.153717824413207e-07, -4.0384911962121353e-07, -2.756833236361445e-07, -1.452269608037682e-07, -2.4535056013519353e-08, 7.7311609597841e-08, 1.5449902962316742e-07, 2.0443016435223171e-07, 2.2739550884054438e-07, 2.260441979651251e-07, 2.0473554515731962e-07, 1.6885156233215072e-07, 1.2413750983597537e-07, 7.612556412794902e-08, 2.967760693195487e-08, -1.1331941571768312e-08, -4.419015052992137e-08, -6.738474767509217e-08, -8.052985459361394e-08, -8.420346513382526e-08, -7.972762500862985e-08, -6.892020725679516e-08, -5.3846087801900923e-08, -3.658949006890566e-08, -1.9064953225012003e-08, -2.8761414760936076e-09, 1.0772269440906257e-08, 2.1111835930565094e-08, 2.780182628614458e-08, 3.088398265127523e-08, 3.071112115282659e-08, 2.7860528124534767e-08, 2.30428136083205e-08, 1.7015152877775107e-08, 1.0506148644395807e-08, 4.156868911309175e-09, -1.497969293051682e-09, -4.815470973085212e-09, -6.221671182971012e-09, -6.587015884962355e-09, -6.377336785323706e-09, -5.8684613979398395e-09, -5.2262879568498735e-09, -4.549397356612417e-09, -3.894093754119865e-09, -3.290558526769516e-09, -2.7524058376915404e-09, -2.2833115803644335e-09, -1.8812845417603974e-09, -1.5412069783934946e-09, -1.2564446710827682e-09, -1.0199930855492313e-09, -8.250201588566597e-10, -6.651852452188578e-10, -5.347845638548065e-10, -4.289057453643608e-10, -3.431341610848904e-10, -2.739761839620769e-10, -2.1838786778971553e-10, -1.737134880386293e-10, -1.3798853615298867e-10, -1.094849721994251e-10, -8.678398444317281e-11, -6.867594493087382e-11, -5.424226401373744e-11, -4.286448529455811e-11, -3.3796823117882017e-11, -2.6648194761946798e-11, -2.0972947822883724e-11, -1.6502781363669782e-11, -1.299213181482628e-11, -1.0240910341963172e-11, -8.003553375601769e-12, -6.284608389250934e-12, -4.9340087571181355e-12, -3.896047928719782e-12, -3.0024693842278794e-12, -2.382876118645072e-12, -1.876969690783881e-12, -1.4733814168721438e-12, -1.1101519703515806e-12, -8.981260180007667e-13, -6.551204023708124e-13, -5.343281372915954e-13, -4.260414243617561e-13, -3.224442934879335e-13, -2.5210056264768357e-13, -2.163602630389505e-13, -1.4335199693960022e-13, -1.0557554830370464e-13, -7.116085498637404e-14, -8.288481012641569e-14, -5.0519588512543125e-14, -2.3305801732931288e-14, -2.7888802378583934e-14, -2.700062395888381e-14, -5.4534154969587694e-15, 1.5210055437364646e-15, 5.773159728050814e-15, -1.3535839116229909e-14, 6.785683126508957e-15, 1.1723955140041654e-14, -1.4210854715202005e-15, 4.7606363295926715e-15, -1.0658141036401502e-16, 6.377121053446899e-15, -1.8918200339612667e-15, -2.082778394196794e-15, -2.326278059072706e-14, 1.6422418980255317e-14, -1.91358040524392e-14, 2.3270274596143282e-15, -8.92619311798626e-15, -6.9722005946459835e-15, 8.526512829121202e-16, -2.304822999121825e-15, -5.919709167301335e-15, 3.794298208958935e-14, -1.6170398353665404e-15, 2.6939561692529424e-14, 1.5516476992161187e-14, 3.603783937933258e-15, 5.524469770534779e-15, 9.64117674584486e-15, -5.282441151166495e-15, -2.842170943040401e-16, -6.368239269249898e-15, 1.5880630144238238e-14, -2.390310172017962e-15, -4.615058335488698e-15, -1.885158695813516e-14, 2.208788707491749e-14, -7.605027718682323e-16, 1.4857004515533844e-14]}, {"name": "Ipd=conv(deconv(Ipd))", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [-1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, -1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, -2.7284841053187846e-14, 0.0, 2.7284841053187846e-14, 1.3642420526593923e-14, 4.547473508864641e-15, 1.8189894035458565e-14, 4.547473508864641e-15, 2.2737367544323206e-15, 6.8212102632969615e-15, -9.094947017729283e-15, 9.094947017729283e-15, 3.524291969370097e-14, 2.842170943040401e-14, 1.1937117960769683e-14, 0.000849556353775256, 0.053816023060801965, 0.1463895464644736, 0.250930950563436, 0.30314604680922375, 0.30890480993851444, 0.2919079713506872, 0.2641336723863725, 0.2323297207044186, 0.20116484748980895, 0.2239827015271311, 0.29014463223483883, 0.42536541875702016, 0.6570908114478137, 1.043424743267001, 1.6203820078795896, 2.3925479398777867, 3.3503958363209554, 4.527769312111466, 5.892930227177867, 7.450095911160799, 9.155476861908907, 11.009626741541215, 12.969555758649063, 15.038923374584053, 17.178896934001518, 19.398460582732834, 21.714424628787587, 24.12901539440419, 26.740963259160846, 29.673966422368395, 33.08977525016141, 37.22793394301795, 42.31637961096603, 48.596126040934564, 56.316949137692504, 65.71598802984448, 77.0580653020984, 90.51822353160112, 106.23029315263244, 124.26441794707955, 144.58247667749131, 167.0251248925955, 191.3140328657563, 217.10994187827413, 243.91099816512215, 271.16447983486586, 298.1930516740303, 324.2492358669144, 348.6021752332755, 370.5260721472145, 389.3303557404861, 404.4403119504836, 415.29502337692503, 421.49991368353227, 422.82602735477377, 419.1941731384132, 410.67859434146436, 397.54752293053116, 380.1855784472464, 359.1145954969681, 334.97811088431496, 308.45576228540995, 280.3035037924515, 251.3004551309997, 222.2340945606672, 193.8084508800187, 166.61985157191333, 141.17558151488157, 118.20435783649253, 98.07961846422474, 80.79429634441813, 66.16006968877026, 53.90625372243798, 43.73503834760721, 35.352404818452165, 28.48630907027814, 22.99530228292849, 18.742714385545803, 15.51640224580462, 13.067567095194804, 11.19787785544996, 9.713543738392076, 8.469929089063667, 7.375320334674768, 6.370216501767437, 5.416906955234981, 4.542795971099628, 3.7719704667288676, 3.1078111915291045, 2.5446639681257417, 2.072817604984623, 1.6811081902187, 1.358327216737117, 1.093960423461936, 0.878538028368637, 0.703758465369721, 0.5624829651572746, 0.44866034659391074, 0.3572182139517237, 0.2839423089611169, 0.22535667749608387, 0.1786115963913529, 0.14138264664717207, 0.11178214740772138, 0.08828288400677128, 0.06965335277781262, 0.054903393606014886, 0.04323895127519139, 0.03402470882472992, 0.026753411929235554, 0.021020817124124697, 0.016505323763713435, 0.01295147814024335, 0.010156658681516105, 0.00796036091134501, 0.006235597392958623, 0.004882011654137744, 0.003820376083051298, 0.002988204379796194, 0.0023362586670672165, 0.0018257735459201797, 0.0014262529157145812, 0.0011137239988555153, 0.0008693551553132428, 0.0006783631907217367, 0.0005291502762950346, 0.0004126229506378853, 0.00032165539229878575, 0.00025066660688903846, 0.00019528772895617788, 0.0001521004410509949, 0.00011843135456068358, 9.219060213565412e-05, 7.174515441389902e-05, 5.5819448317040435e-05, 4.341756853990736e-05, 3.376217760297223e-05, 2.624678799531604e-05, 2.0398374372672182e-05, 1.5848126654418593e-05, 1.2308583254707628e-05, 9.555740421092196e-06, 7.415147724714189e-06, 5.750923564846744e-06, 4.457324125723972e-06, 3.4520377789704073e-06, 2.6710090287451748e-06, 2.0644187611651433e-06, 1.593515551121527e-06, 1.2281455542506593e-06, 9.448998946481879e-07, 7.255281195739372e-07, 5.558464681598707e-07, 4.2481583648168455e-07, 3.238424147866681e-07, 2.4621534635116403e-07, 1.8672329389346489e-07, 1.4128410867897402e-07, 1.0671099886394587e-07, 8.053063567103891e-08, 6.07878129699202e-08, 4.596555811531289e-08, 3.4869209883936495e-08, 2.659011244077192e-08, 2.0423493225507628e-08, 1.5823004915205276e-08, 1.2257392469905427e-08, 9.494208370597335e-09, 7.353195030646021e-09, 5.694398268474288e-09, 4.409356932910669e-09, 3.4139826787793484e-09, 2.64303075425687e-09, 2.0460062666316504e-09, 1.5478671322455284e-09, 1.1263568744368514e-09, 7.821933678542337e-10, 5.157826343804572e-10, 3.0956872620890865e-10, 1.6795554280690795e-10, 7.619800790337195e-11, 2.3178685637503805e-11, 2.679634292235278e-14, 2.424727085781342e-14, 6.588063428125679e-15, 2.4498181261378704e-14, 1.9038104426272183e-14, 2.1477264411373655e-14, -1.1785017406396037e-14, 6.362688154126772e-15, -1.059707877004712e-15, 1.529276705269922e-14, 7.294165271787279e-15, -1.790234627208065e-16, 2.1027624086400466e-15, 6.34936547783127e-15, -8.107958748837518e-15, 5.864198016070077e-15, -2.0470986017429026e-14, 1.1932677068671183e-14, -2.7389826517953963e-14, 8.207740043175705e-15, -2.4732334236166056e-14, -2.8357732828609984e-14, -1.8458290451661696e-14, 1.1855325748877377e-14, -3.775264822980518e-14, -2.261590220653531e-14, -1.4449127658244797e-14, 1.4944382537018797e-15, -1.54153599607465e-15, 1.4258724409521583e-14, 5.944468008112214e-15, -5.640988978011796e-15, -3.8901520893475096e-14, 3.9934234304789264e-15, 2.5641056118630435e-15, 1.8173663528936456e-14, -1.2291231400729519e-15, -4.547473508864641e-15, 9.094947017729283e-15, 4.547473508864641e-15, 4.547473508864641e-15, 9.094947017729283e-15, -1.3642420526593923e-14, 1.5916157281026246e-14, 1.3642420526593923e-14, 2.955857780762017e-14, 1.5916157281026246e-14, -2.0463630789890885e-14, 1.0231815394945442e-14, -1.0231815394945442e-14, 4.547473508864641e-15, -1.8758328224066646e-14, -6.252776074688882e-15, -1.2505552149377763e-14, 7.105427357601002e-15, -9.947598300641404e-15, -3.126388037344441e-15, -7.673861546209083e-15, -9.947598300641404e-15, 5.684341886080802e-16, -2.5153212845907547e-14, 1.8474111129762605e-14, 2.856381797755603e-14, -2.6361135496699717e-14, -3.04822833641083e-14, 9.663381206337363e-15, 3.581135388230905e-14, 3.68771679859492e-14, -9.947598300641404e-16, -7.993605777301127e-16, 2.4371615836571438e-14, 2.153832667772804e-15, 3.2152058793144534e-15, 2.3252511027749278e-14, 1.8260948309034574e-14, 1.2416734307407751e-14, -2.0250467969162858e-15, -2.9309887850104134e-16, 2.702726931147481e-14, -2.863487225113204e-14, -2.2817303602096218e-14, -7.762679388179095e-15, 2.410738275671065e-14, 2.786659791809143e-15, 1.2794210135780305e-14, -2.1505019986989283e-15, 4.163336342344337e-16, -8.636424908559093e-15, -1.5993317781237693e-14, 6.233902283270254e-16, 1.8007817459420038e-15, 4.7264969715854475e-15, -2.1027624086400466e-15, -1.7718049249992874e-14, -3.260725023324085e-15, -2.405409205152864e-14]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "$\\text{Actual } E_{pd} \\text{ vs. deconvolution of } I_{pd}$", "x": 0.5, "xanchor": "center"}, "xaxis": {"title": {"text": "Day"}}, "yaxis": {"title": {"text": "Count"}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('4c6c68c5-fa04-4ce1-bfbd-c6bf5dee01c1');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The iterative deconvolution seems to work nicely and we get close results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-$I_{pd}$-from-the-model-to-$I_{pd}$-obtained-by-de-convolving-$R_{pd}$">
<a class="anchor" href="#Comparing-%24I_%7Bpd%7D%24-from-the-model-to-%24I_%7Bpd%7D%24-obtained-by-de-convolving-%24R_%7Bpd%7D%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comparing $I_{pd}$ from the model to $I_{pd}$ obtained by de-convolving $R_{pd}$<a class="anchor-link" href="#Comparing-%24I_%7Bpd%7D%24-from-the-model-to-%24I_%7Bpd%7D%24-obtained-by-de-convolving-%24R_%7Bpd%7D%24"> </a>
</h3>
<p>Let's try the same thing but using $R_{pd}$ to get $I_{pd}$:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1">#regularization parameter</span>
<span class="n">alpha</span><span class="o">=</span><span class="mi">2</span>

<span class="c1"># Setup up the resultant Ipd we want to compare our guess with</span>
<span class="n">Rpd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
<span class="n">Rpd</span><span class="p">[</span><span class="n">Rpd</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># Find delay caused by h_I</span>
<span class="n">delay</span><span class="o">=</span><span class="n">Rpd</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="o">-</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">Rpd</span><span class="p">,</span> <span class="n">h_I</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>

<span class="c1"># We want initial guess to simply be the result of the convolution delayed</span>
<span class="n">initial_guess</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">Rpd</span><span class="p">,</span><span class="n">delay</span><span class="p">)</span>
<span class="n">Inext</span> <span class="o">=</span> <span class="n">initial_guess</span>


<span class="c1"># AN array to record MSE between result we want and our iterated guess</span>
<span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="n">msecalc</span><span class="p">(</span><span class="n">Rpd</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_I</span><span class="p">,</span> <span class="n">Inext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">Rpd</span><span class="p">)]))</span>

<span class="n">itercount</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">mse</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mse</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
  <span class="n">itercount</span><span class="o">=</span><span class="n">itercount</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">Inext</span><span class="o">=</span><span class="n">iter_deconv</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">h_I</span><span class="p">,</span> <span class="n">Inext</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">Rpd</span><span class="p">)</span>
  <span class="n">mse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="n">msecalc</span><span class="p">(</span><span class="n">Rpd</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_I</span><span class="p">,</span> <span class="n">Inext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">Rpd</span><span class="p">)]))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Iteration #"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itercount</span><span class="p">)</span> <span class="o">+</span><span class="s2">": MSE= "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mse</span><span class="p">[</span><span class="n">itercount</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Iteration #"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itercount</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span><span class="s2">": MSE= "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mse</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" so we use the result of the previous iteration."</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration #1: MSE= 166.72190714942613
Iteration #2: MSE= 25.569889450476406
Iteration #3: MSE= 13.843314263045501
Iteration #4: MSE= 8.628213904576954
Iteration #5: MSE= 8.000003180274252
Iteration #6: MSE= 5.92374081714056
Iteration #7: MSE= 5.79711361370541
Iteration #8: MSE= 4.215547918598343
Iteration #9: MSE= 4.298363884056574 so we use the result of the previous iteration.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>    
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd=lowpass(Ipd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">5</span><span class="p">])),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Ipd=deconv(Rpd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">Inext</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Rpd'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Rpd=conv(Inext)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_I</span><span class="p">,</span> <span class="n">Inext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Rpd=lowpass(Rpd)'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">lowpass</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">6</span><span class="p">])),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Rpd=conv(deconv(Rpd))'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">h_I</span><span class="p">,</span> <span class="n">Inext</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'full'</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">Rpd</span><span class="p">)])</span>    
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    
    <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s1">'Day'</span><span class="p">,</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s1">'Count'</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span><span class="sa">r</span><span class="s1">'$\text{Actual } I_</span><span class="si">{pd}</span><span class="s1"> \text{ vs. deconvolution of } R_</span><span class="si">{pd}</span><span class="s1">$'</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span><span class="s1">'center'</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="a4193e80-9c82-460a-9334-818f46693f00" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("a4193e80-9c82-460a-9334-818f46693f00")) {
                    Plotly.newPlot(
                        'a4193e80-9c82-460a-9334-818f46693f00',
                        [{"name": "Ipd", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 2, 1, 2, 2, 1, 2, 2, 2, 3, 3, 4, 2, 11, 9, 5, 10, 10, 7, 12, 21, 21, 27, 22, 21, 26, 23, 41, 54, 58, 47, 75, 108, 83, 107, 133, 141, 163, 179, 201, 222, 284, 299, 314, 313, 361, 391, 405, 450, 424, 439, 411, 412, 437, 401, 343, 322, 301, 278, 231, 181, 194, 139, 151, 109, 102, 93, 73, 53, 46, 27, 34, 17, 19, 19, 16, 7, 6, 6, 5, 4, 3, 2, 4, 0, 2, 1, 2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"name": "Ipd=lowpass(Ipd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0.022791818372247682, 0.028350606202941355, 0.032198648058805165, 0.0343631988814043, 0.03491767796763867, 0.03400490792675115, 0.03187413711900923, 0.02892723394906289, 0.025766782130384577, 0.02323675558692251, 0.022445341412394838, 0.024759624390758916, 0.03176354004480663, 0.045174006852189495, 0.06671562287946041, 0.09796157973173207, 0.1401566275936618, 0.19404533767416643, 0.25973361112103516, 0.3366120803414963, 0.4233665808327322, 0.5180939154935621, 0.6185315071398791, 0.7223978232612823, 0.8278272457747763, 0.9338693760240668, 1.0410102093281144, 1.15166317121478, 1.270573768459888, 1.4050842549502078, 1.5652147707936406, 1.763533750138467, 2.0148104906181543, 2.33546372171832, 2.742839567463819, 3.254369408078296, 3.8866727030890025, 4.65468224748593, 5.570880293998659, 6.64474452612425, 7.882513793040441, 9.287393200939578, 10.86032031934752, 12.601399154328504, 14.51206820760568, 16.598002638978773, 18.87266667298957, 21.36134592178782, 24.105414705694336, 27.166535715583926, 30.63044015747944, 34.60988099665811, 39.246282912034104, 44.709542698220424, 51.19539658199237, 58.9198078606327, 68.1099691967038, 78.9917639394939, 91.77387375454623, 106.62912738753627, 123.6741173909161, 142.94851226659935, 164.3957978605799, 187.84734098812095, 213.0116454922335, 239.47045009988992, 266.68290488412146, 293.9984945409002, 320.6787130241559, 345.92680003894355, 368.9241697834924, 388.87152069534847, 405.03204675247895, 416.7737476979975, 423.6076526126627, 425.21890182759074, 421.48808803966466, 412.5009841869795, 398.5456915023538, 380.09723604303866, 357.79065420675306, 332.38456688816603, 304.71805377711405, 275.6641936167074, 246.08384920476416, 216.7831231499446, 188.4774219970174, 161.7643065397369, 137.10636716466422, 114.82436505813304, 95.09995407841724, 77.98655497557966, 63.42646139135073, 51.272035532770914, 41.30887776569511, 33.27907300676093, 26.90295508961961, 21.898219134531438, 17.995601523909947, 14.95070996856791, 12.551910521363196, 10.624459028703154, 9.031295910244864, 7.671096270790743, 6.474271850441063, 5.3976525620216975, 4.418539496607709, 3.5287335010409024, 2.729022134841365, 2.0244702096478377, 1.4207198584958163, 0.9213770040391663, 0.5264509822807518, 0.23172877135295283, 0.028907852401891886, -0.0937176364090434, -0.15022683755671515, -0.1558912428954463, -0.1260052680367721, -0.07485204303061045, -0.014887190066768698, 0.04381548821188712, 0.09384645386587703, 0.13048859806598365, 0.1515290823168609, 0.15690585505147545, 0.1482459045620166, 0.12835219312933072, 0.10069106510001662, 0.06892308644169627, 0.03650918008885048, 0.006411939637466165, -0.01909965810338965, -0.03854429260851626, -0.051231632967881635, -0.05719152059083545, -0.05704907477756995, -0.051866938868128466, -0.042974965815141264, -0.031805099421915395, -0.019745548086475738, -0.008024089646857947, 0.002374030047052791, 0.01075222794162442, 0.01671485131076459, 0.020150368421420876, 0.021192045973562175, 0.020163552678242998, 0.01751698298657981, 0.013770167987279694, 0.009449007588531014, 0.005039109358178232, 0.0009494397775747001, -0.0025108525646616287, -0.00514266261687815, -0.006855543979049553, -0.0076568588076604376, -0.007634080371066094, -0.006933022191948877, -0.005734648565471181, -0.004232785518698796, -0.0026145667575557794, -0.001044885089308824, 0.00034445950051969847, 0.0014607640578126327, 0.002251887583618595, 0.00270383694176786, 0.002835365537346106, 0.0026905880291960096, 0.0023306167371926222, 0.0018251375234689126, 0.0012446883560125847, 0.0006542079402544491, 0.00010820941854497107, -0.00035227294599287387, -0.00070100038608024, -0.0009262946810118393, -0.0010295431338651177, -0.00102279673968881, -0.0009258342477442087, -0.0007630475688810364, -0.0005604579743146603, -0.00034310689759083524, -0.0001329891740929623, 5.238117599364774e-05, 0.00020075474423955416, 0.00030532346723086487, 0.00036438033847498624, 0.00038058264123931395, 0.00035995365671987064, 0.0003107576427813076, 0.0002423707025960607, 0.0001642491527526764, 8.507057416206866e-05, 1.2094191945545278e-05, -4.9240499641295496e-05, -9.548253719683975e-05, -0.00012513117616646353, -0.00013842999718385038, -0.0001370410437200401, -0.0001236490230991847, -0.0001015431297192216, -7.421775767357186e-05, -4.5024487779199364e-05, -1.6897506564473566e-05, 7.835809548157072e-06, 2.7557067035205566e-05, 4.1377865000020505e-05, 4.9091914119876136e-05, 5.1074553297196226e-05, 4.8147813086286314e-05, 4.142908948780609e-05, 3.2179807064707577e-05, 2.1667595855563113e-05, 1.1051941248728005e-05, 1.2994323336503763e-06, -6.868978402695035e-06, -1.2999572168764068e-05, -1.6899817321154443e-05, -1.8610038728791597e-05, -1.8359219421544422e-05, -1.651165014500224e-05, -1.351078945199987e-05, -9.825836980252336e-06, -5.905320823584211e-06, -2.1406233636074755e-06, 1.1590279371295482e-06, 3.7798688473546537e-06, 5.606056509302277e-06, 6.6129493345149345e-06, 6.8534092179094535e-06, 6.439566484960943e-06, 5.522467960862454e-06, 4.271795743388675e-06, 2.857456570541679e-06, 1.4343607434152412e-06, 1.3119462236303576e-07, -9.56506297712326e-07, -1.7691145249456463e-06, -2.281978500344949e-06, -2.5015277644812583e-06, -2.4592798968723485e-06, -2.204650530875938e-06, -1.7974175686994118e-06, -1.3005732389626106e-06, -7.741350840812409e-07, -2.70301719364094e-07, 1.698482217041498e-07, 5.180880231401347e-07, 7.593244996499561e-07, 8.906569670309595e-07, 9.195108064169133e-07, 8.611737303516234e-07, 7.360590301251901e-07, 5.669879467431698e-07, 3.7673066895033894e-07, 1.859805984922149e-07, 1.1867362099641299e-08, -1.329524795388783e-07, -2.406464874001206e-07, -3.080651161495387e-07, -3.3620664710478616e-07, -3.294047586189277e-07, -2.943596910342068e-07, -2.391268545291824e-07, -1.7216068515411335e-07, -1.0148956781382038e-07, -3.40727153355648e-08, 2.463523955046863e-08, 7.090923660559736e-08, 1.0278494034807023e-07, 1.1992706544660004e-07, 1.2337503916248934e-07, 1.1521013175979579e-07, 9.818751753815734e-08, 7.537229245746458e-08, 4.98113216068392e-08, 2.4264032672680415e-08, 1.0059714449540587e-09, -1.8289982606313563e-08, -3.259764845839737e-08, -4.1515920823894476e-08, -4.5194891396519956e-08, -4.4225469244183956e-08, -3.950879349974155e-08, -3.212071754416248e-08, -2.3184436472574803e-08, -1.3761331380214983e-08, -4.766718258420323e-09, 3.086215687822377e-09, 9.314122993927427e-09, 1.3665290117662473e-08, 1.6099891632652148e-08, 1.6754300022863208e-08, 1.5895555621631854e-08, 1.3871972546738257e-08, 1.1065205888501855e-08, 7.848074874385862e-09, 4.551177971528856e-09]}, {"name": "Ipd=deconv(Rpd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 5.0, 7.0, 9.0, 12.0, 15.0, 18.0, 21.0, 24.0, 27.0, 30.0, 34.0, 38.0, 43.0, 48.0, 55.0, 63.0, 73.0, 85.0, 99.0, 116.0, 135.0, 156.0, 179.0, 204.0, 230.0, 258.0, 285.0, 312.0, 338.0, 362.0, 383.0, 400.0, 413.0, 422.0, 425.0, 423.0, 416.0, 403.0, 385.0, 363.0, 338.0, 309.0, 279.0, 247.0, 215.0, 183.0, 153.0, 125.0, 100.0, 77.0, 58.0, 43.0, 31.0, 21.0, 15.0, 11.0, 9.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 14.0, 14.0, 13.0, 11.0, 9.0, 6.0, 3.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"name": "Rpd", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 4, 0, 1, 1, 0, 0, 1, 1, 2, 3, 2, 3, 5, 4, 2, 0, 9, 8, 11, 9, 11, 17, 10, 6, 24, 17, 24, 31, 35, 49, 37, 44, 61, 73, 71, 82, 96, 110, 129, 133, 138, 174, 181, 183, 216, 227, 225, 260, 284, 259, 276, 310, 280, 352, 288, 351, 331, 314, 299, 305, 261, 276, 267, 272, 252, 243, 193, 193, 183, 140, 170, 123, 122, 117, 96, 100, 76, 68, 65, 62, 40, 47, 40, 34, 29, 27, 23, 20, 19, 14, 4, 10, 3, 4, 4, 2, 6, 3, 1, 2, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"name": "Rpd=conv(Inext)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [-9.094947017729283e-15, -9.094947017729283e-15, 0.0, -1.8189894035458565e-14, -9.094947017729283e-15, -1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, -3.637978807091713e-14, -1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, -1.8189894035458565e-14, -3.637978807091713e-14, 0.0, -1.8189894035458565e-14, -1.8189894035458565e-14, -3.637978807091713e-14, 1.8189894035458565e-14, 0.0, 9.094947017729283e-15, 9.094947017729283e-15, -1.8189894035458565e-14, -2.7284841053187846e-14, 1.8189894035458565e-14, 0.0010044631988967013, 0.004936816669514883, 0.012496926434241686, 0.024077348857372272, 0.03889540968201345, 0.05511437288908383, 0.07200144089005789, 0.08902132162265389, 0.10570855519372345, 0.12164162441452846, 0.13643889980495033, 0.14976204441360552, 0.16132199962231425, 0.17088530292762244, 0.17827947964844726, 0.18440119818742687, 0.19314122044260784, 0.21107892350474344, 0.24594810684676077, 0.30615329079866, 0.40146067663315477, 0.5436531487717815, 0.7450669391824392, 1.0180626694350163, 1.3746515780750845, 1.8261791393324607, 2.383049788179942, 3.0554953705298264, 3.8542995523277366, 4.790428649025132, 5.875540186276807, 7.1225426842214805, 8.547988879213966, 10.172305514932338, 12.021639209491369, 14.128506611900939, 16.533093455118177, 19.284238010352535, 22.438076889255825, 26.057430913215494, 30.211167389521247, 34.97245077528638, 40.41697152159076, 46.62021407479787, 53.6519908742748, 61.57438803892328, 70.4374433467642, 80.27433680185693, 91.09646469112653, 102.88958817672014, 115.61211737727078, 129.1924167820028, 143.52609964556228, 158.4774215366037, 173.87972134738078, 189.53656718959672, 205.22664884780193, 220.71018676038994, 235.73429756508966, 250.0391737812906, 263.36691228924997, 275.4678006061165, 286.1085820406525, 295.07979968100665, 302.20375902412735, 307.34004093525454, 310.3893421009462, 311.29588629230904, 310.05139721798395, 306.6946481971194, 301.30749769780715, 294.01201630757066, 284.9679520220316, 274.36554736142375, 262.41983470061257, 249.3639786430313, 235.4407029147922, 220.89414889755702, 205.9635296875055, 190.8776558342157, 175.84926560762048, 161.07028329269446, 146.70909003123222, 132.90684448109704, 119.776763579443, 107.40441443431479, 95.84778002713009, 85.1409573492895, 75.29836096544956, 66.31797928188188, 58.18358184381014, 50.8659997638536, 44.325546376856, 38.51457094461046, 33.37992408820436, 28.865229350147697, 24.912894388631802, 21.46582142831957, 18.468797876595108, 15.869566046511364, 13.619585893238659, 11.674516468348438, 9.994450355932589, 8.543940735834843, 7.291863130216264, 6.211153672048679, 5.278463332053385, 4.473763461815024, 3.7799327863274206, 3.1823501255925475, 2.668511111937787, 2.2276813959913015, 1.8505936110715897, 1.5291909099995298, 1.2564163235218007, 1.026044553612627, 0.8325510734886535, 0.6710124688714386, 0.5370316934306624, 0.4266821764677532, 0.33646535904193864, 0.2632771004651988, 0.2043793629005494, 0.15737454421712724, 0.12018071159742241, 0.09100674056001878, 0.06832696016381794, 0.050855339519455055, 0.03751953313891227, 0.02743525337332742, 0.019881483355874006, 0.01427701150335293, 0.010158685594790266, 0.007161674288843187, 0.005001905707210881, 0.0034607404659573147, 0.002371839544748582, 0.0016101106704354607, 0.0010825620533250913, 0.0007208584292402521, 0.00047535883884393116, 0.00031041494179135043, 0.00020071914860636753, 0.00012850984726355818, 8.146333815147954e-05, 5.1126189878232256e-05, 3.176564895966294e-05, 1.953813600266585e-05, 1.189591803267831e-05, 7.169368304857926e-06, 4.276720210327767e-06, 2.525032600715349e-06, 1.4754644689674024e-06, 8.532490301149664e-07, 4.883013752987609e-07, 2.765319050013204e-07, 1.5496294508920982e-07, 8.592437552579213e-08, 4.714013812190388e-08, 2.558779442551895e-08, 1.3741130260314095e-08, 7.300307061086642e-09, 3.836819360003574e-09, 1.9947628970840013e-09, 1.0258327165502123e-09, 5.218339538259898e-10, 2.625574779813178e-10, 1.3067847248748877e-10, 6.429786481021438e-11, 3.131731318717357e-11, 1.5074874681886285e-11, 7.184439709817525e-12, 3.403215487196576e-12, 1.588773557159584e-12, 7.116796041373163e-13, 3.3935521059902383e-13, 1.6228796084760688e-13, 8.15703060652595e-14, 3.666400516522117e-14, 2.5863755581667648e-14, -1.7053025658242404e-15, 2.4300561562995426e-14, 2.6005864128819668e-14, 1.7621459846850484e-14, 7.318590178329032e-15, 1.7905676941154525e-14, 2.2453150450019167e-14, 3.019806626980426e-16, 2.112088282046898e-14, 3.080202759520034e-14, -4.973799150320702e-15, 8.384404281969182e-15, 7.105427357601002e-16, 1.4921397450962105e-14, 1.3002932064409834e-14, -1.0658141036401502e-15, -1.8047785488306545e-14, 1.2843059948863812e-14, 1.91491267287347e-14, -5.702105454474804e-15, -2.206235194535111e-14, 4.494182803682634e-15, 9.805489753489383e-15, -5.413447468072263e-15, -1.2105871860512708e-14, 9.108269694024785e-15, -4.75397499144492e-15, -1.8953727476400672e-14, -1.6329160246186804e-14, -1.1295409052536344e-14, 1.5198953207118392e-15, -2.863209669357047e-14, -1.653066572515627e-14, -2.0463630789890885e-14, -1.1368683772161604e-14, -4.092726157978177e-14, -2.7284841053187846e-14, -9.094947017729283e-15, -1.8189894035458565e-14, -9.094947017729283e-15, -4.092726157978177e-14, -4.092726157978177e-14, -2.7284841053187846e-14, -4.5474735088646414e-14, -2.2737367544323207e-14, -2.2737367544323207e-14, -2.2737367544323207e-14, -3.637978807091713e-14, -1.8189894035458565e-14, -2.2737367544323207e-14, 0.0, -1.3642420526593923e-14, -1.8189894035458565e-14, -9.094947017729283e-15, -1.8189894035458565e-14, 4.547473508864641e-15, 0.0, -9.094947017729283e-15, 9.094947017729283e-15, -2.0463630789890885e-14, -2.5011104298755527e-14, -6.8212102632969615e-15, -1.1368683772161604e-14, -1.3642420526593923e-14, 4.547473508864641e-15, 1.1368683772161604e-14, 4.547473508864641e-15, 2.2737367544323206e-15, 1.1368683772161603e-15, 7.958078640513123e-15, 4.547473508864641e-15, 8.526512829121202e-15, -5.115907697472721e-15, 1.5347723092418165e-14, 1.3642420526593923e-14, 2.842170943040401e-15, 8.526512829121202e-16, 6.536993168992922e-15, 2.5579538487363606e-15, 1.7905676941154525e-14, 6.252776074688882e-15, 1.4068746168049984e-14, 2.1316282072803005e-15, 1.4210854715202004e-14, -1.7763568394002505e-15, 9.947598300641404e-15, 2.3021584638627248e-14, 3.019806626980426e-16, -2.4691360067663484e-15, -4.618527782440651e-16, 4.263256414560601e-15, 9.521272659185343e-15, 8.952838470577262e-15, -4.405364961712621e-15, 9.734435479913373e-15, 1.7550405573274476e-14, 1.6910917111090384e-14, 6.483702463810914e-15, 1.268318783331779e-14, 3.412381488487881e-14, 4.618527782440651e-16, 1.7106316363424413e-14, 1.7479351299698464e-14, 3.139710713639943e-15, 9.832135106080387e-15, 9.08162434143378e-15, -6.6147087807166825e-15, -8.331113576787175e-15, 7.23421322845752e-15, 1.1295409052536344e-14, 1.6669998714746726e-14, 2.863209669357047e-14, 3.9268033269479473e-14, 4.5474735088646414e-14, 1.8189894035458565e-14, 0.0, 1.8189894035458565e-14, 3.637978807091713e-14, 1.8189894035458565e-14, 1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, 0.0, -1.8189894035458565e-14, 0.0, 0.0, -1.8189894035458565e-14, 0.0, 3.637978807091713e-14, 0.0, 1.8189894035458565e-14, 1.8189894035458565e-14, 1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, 1.8189894035458565e-14, 0.0, 1.8189894035458565e-14, 1.8189894035458565e-14, 0.0, 0.0, -9.094947017729283e-15, -2.7284841053187846e-14, -9.094947017729283e-15, 9.094947017729283e-15, 0.0, 0.0, 0.0, -4.547473508864641e-15, 4.547473508864641e-15, 4.547473508864641e-15, -4.547473508864641e-15, -4.547473508864641e-15, 4.547473508864641e-15, -1.5916157281026246e-14, -4.547473508864641e-15, -6.8212102632969615e-15, 4.547473508864641e-15, 4.547473508864641e-15, -1.2505552149377763e-14, -1.2505552149377763e-14, 1.2505552149377763e-14, 7.958078640513123e-15, -7.958078640513123e-15, -1.4210854715202004e-14, 1.7053025658242404e-15, 1.0231815394945442e-14, -5.115907697472721e-15, -6.252776074688882e-15, 2.3021584638627248e-14, -7.673861546209083e-15, -4.263256414560601e-15, -2.842170943040401e-15, 1.5347723092418165e-14, 2.2879476091475227e-14, 1.1368683772161604e-14, -5.186961971048731e-15, 1.8474111129762605e-15, 1.8758328224066646e-14, -7.105427357601002e-16, -2.792432951537194e-14, 3.4106051316484808e-15, 4.6540549192286564e-15, 4.876099524153688e-15, -1.8127721546079556e-14, 1.4219736499399006e-14, 1.3313794511304877e-14, -6.519229600598919e-15, -1.9104717807749695e-14, 5.24913446042774e-15, 1.0478284906412227e-14]}, {"name": "Rpd=lowpass(Rpd)", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [-0.005458805688506905, -0.00537643661830544, -0.0046931065693848785, -0.0033564681434687027, -0.0013743205313858113, 0.0011733621481841636, 0.004127652362457195, 0.007250996115474841, 0.010236134689103449, 0.012724510220204141, 0.014334226398158886, 0.014696644059535621, 0.013499597895591318, 0.01053412254851634, 0.005740592415078637, -0.0007505601799755665, -0.008588748807444063, -0.017188833744493884, -0.025736793877045944, -0.033218529217522386, -0.038472948590711153, -0.04026809731652338, -0.03739635819714776, -0.028781963147423414, -0.013591491562309474, 0.008663947454878224, 0.038047197449912806, 0.0741463532587428, 0.11606937724109256, 0.16248937930520713, 0.21174342290835935, 0.26198236582222784, 0.31136374795729355, 0.35827488774871974, 0.40156962933436197, 0.4407995760790089, 0.47641885709034365, 0.5099403628792112, 0.5440212789510395, 0.582457690653311, 0.6300738909145986, 0.6925036213183232, 0.7758776931492759, 0.8864518741172287, 1.0302249725998678, 1.212604672535301, 1.438175712959075, 1.7106127596147542, 2.032762674808292, 2.4069026524960098, 2.8351656376917735, 3.32011412426323, 3.8654370378935896, 4.476739577522618, 5.1623893827778256, 5.934371340891605, 6.809087886541556, 7.808027627431017, 8.958222686423882, 10.292432201084521, 11.849025352788653, 13.671582464391571, 15.80827275951306, 18.31108824433996, 21.235005897957024, 24.637116178859547, 28.575707640275205, 33.10925412168216, 38.29522898836848, 44.188678375733836, 50.840519391942856, 58.295575678786555, 66.59040298388935, 75.75097982693974, 85.79034407111794, 96.70625274344151, 108.47893489836895, 121.06899880154535, 134.4155514843348, 148.4345984448466, 163.01781515301556, 178.03181238650293, 193.3180444881404, 208.69352762094078, 223.9525404591697, 238.86946744385978, 253.20290943924675, 266.70112610334695, 279.1087899871998, 290.1749266539733, 299.6617873160879, 307.35425010504247, 313.0691867340383, 316.66410085423183, 318.0442941221606, 317.1678853385654, 314.0482048481587, 308.7533805806341, 301.403259517277, 292.1640867292172, 281.24152272417086, 268.8725903854515, 255.31703305678704, 240.84840787719673, 225.74511819065737, 210.28156131111908, 194.71963117234543, 179.3009155224749, 164.2399944978959, 149.7192356053627, 135.8853842350753, 122.84809538595776, 110.68037942228851, 99.42077615069708, 89.07695030863407, 79.63032993893606, 71.04138880533354, 63.255195617862874, 56.20689943155959, 49.8268758136018, 44.04531263126766, 38.79606421311207, 34.019648066249836, 29.665301797103822, 25.692063891090015, 22.06889398449376, 18.773906157791053, 15.792849668208913, 13.117030575541783, 10.740917443664143, 8.659704194896307, 6.867102147349883, 5.353595053920418, 4.105319012578106, 3.103636427666403, 2.3253776621473894, 1.7436428913052737, 1.3290024724339178, 1.0509120250793924, 0.879165519256008, 0.7852375324351454, 0.743404661739332, 0.7315779570058712, 0.7318178117757399, 0.7305364129336522, 0.718418211980946, 0.6901049211463988, 0.6436989841074483, 0.5801406299997552, 0.5025114182110303, 0.4153139459899346, 0.3237740083920719, 0.23320733037661961, 0.14848664286085045, 0.07363546209471787, 0.011562889909717884, -0.036059353899087696, -0.06878874144216109, -0.0872936083992304, -0.09315241775182875, -0.08860152843527186, -0.0762622205561109, -0.058874748416600176, -0.039062124319880966, -0.01913999767808358, -0.0009821883724411206, 0.014055128471069394, 0.0251533409294176, 0.03200272516384348, 0.03473561135402673, 0.033833493221758985, 0.030020484168895106, 0.024154660726925004, 0.0171270842727947, 0.009775963471248726, 0.0028208206769925275, -0.0031810649174692503, -0.007856015635628856, -0.011015135648066374, -0.01263876369616599, -0.012848526594471795, -0.011871664534266902, -0.010002168209952611, -0.007562756563363183, -0.004870943744557758, -0.002211510758717673, 0.0001832791900419005, 0.002145307959305337, 0.0035744592740352635, 0.004435718344193597, 0.0047509541086075985, 0.0045870474711838805, 0.004042064904446865, 0.0032310547570863473, 0.0022728019788755957, 0.0012785582018232052, 0.0003434101160476211, -0.0004594023855884398, -0.0010812247969098374, -0.0014980517498813946, -0.001708376606209065, -0.0017294051184948503, -0.001592256767802139, -0.0013367591206291767, -0.001006371373528128, -0.0006436682270956268, -0.000286689989309152, 3.366593259424896e-05, 0.00029516059074483693, 0.00048469120138612667, 0.0005978692294656122, 0.0006378933778610481, 0.000613941100729276, 0.0005393063005210416, 0.0004294938607222018, 0.00030044880056058064, 0.0001670548152910449, 4.1989401323919755e-05, -6.502429863178738e-05, -0.0001475712408221002, -0.00020254096598944238, -0.00022982942137293933, -0.0002318241322183488, -0.00021275649421857672, -0.00017800222743770508, -0.00013340153614741147, -8.465628556519028e-05, -3.684463343032044e-05, 5.923990453387461e-06, 4.070719532156395e-05, 6.57890879185575e-05, 8.061977241469118e-05, 8.566121075387153e-05, 8.216954118027269e-05, 7.194438332484504e-05, 5.7073285948114505e-05, 3.969499885548812e-05, 2.1799439952096973e-05, 5.07583399010616e-06, -9.185805560823948e-06, -2.0140348096315668e-05, -2.7385502992098415e-05, -3.0920563126961256e-05, -3.107645759647506e-05, -2.842836556001626e-05, -2.3701739794131454e-05, -1.7681286108549432e-05, -1.1130516428930322e-05, -4.727220491609372e-06, 9.821531206587795e-07, 5.608426903757698e-06, 8.927050862072354e-06, 1.0869466145164203e-05, 1.1502035726765321e-05, 1.0996592310721293e-05, 9.596696609245667e-06, 7.583368866312919e-06, 5.243447570457851e-06, 2.8429447050384377e-06, 6.069073510508363e-07, -1.2935491456907114e-06, -2.7471280384739422e-06, -3.70186636232603e-06, -4.159432620817001e-06, -4.165626195438748e-06, -3.798589709306787e-06, -3.1561865075651283e-06, -2.3438168769255924e-06, -1.463685392634333e-06, -6.062256076096928e-07, 1.559276248153869e-07, 7.713236482387388e-07, 1.2105974313960815e-06, 1.4652395385184244e-06, 1.5447163491822962e-06, 1.472485783707728e-06, 1.2814575282673185e-06, 1.009400760941145e-06, 6.947194217870112e-07, 3.7290899107639953e-07, 7.389303982647618e-08, -1.7967549403968454e-07, -3.731645631912791e-07, -4.998632333432661e-07, -5.601893948593305e-07, -5.603972215770421e-07, -5.109881228493249e-07, -4.250201680084262e-07, -3.1648621845957206e-07, -1.98895242293018e-07, -8.414959572226557e-08, 1.8231825799637485e-08, 1.0153470232631844e-07, 1.619389062975612e-07, 1.9832697605569606e-07, 2.1187894032282475e-07, 2.055291101955881e-07, 1.833603183908326e-07, 1.500040459189028e-07]}, {"name": "Rpd=conv(deconv(Rpd))", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "y": [-9.094947017729283e-15, -9.094947017729283e-15, 0.0, -1.8189894035458565e-14, -9.094947017729283e-15, -1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, -3.637978807091713e-14, -1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, 0.0, -1.8189894035458565e-14, -1.8189894035458565e-14, -3.637978807091713e-14, 0.0, -1.8189894035458565e-14, -1.8189894035458565e-14, -3.637978807091713e-14, 1.8189894035458565e-14, 0.0, 9.094947017729283e-15, 9.094947017729283e-15, -1.8189894035458565e-14, -2.7284841053187846e-14, 1.8189894035458565e-14, 0.0010044631988967013, 0.004936816669514883, 0.012496926434241686, 0.024077348857372272, 0.03889540968201345, 0.05511437288908383, 0.07200144089005789, 0.08902132162265389, 0.10570855519372345, 0.12164162441452846, 0.13643889980495033, 0.14976204441360552, 0.16132199962231425, 0.17088530292762244, 0.17827947964844726, 0.18440119818742687, 0.19314122044260784, 0.21107892350474344, 0.24594810684676077, 0.30615329079866, 0.40146067663315477, 0.5436531487717815, 0.7450669391824392, 1.0180626694350163, 1.3746515780750845, 1.8261791393324607, 2.383049788179942, 3.0554953705298264, 3.8542995523277366, 4.790428649025132, 5.875540186276807, 7.1225426842214805, 8.547988879213966, 10.172305514932338, 12.021639209491369, 14.128506611900939, 16.533093455118177, 19.284238010352535, 22.438076889255825, 26.057430913215494, 30.211167389521247, 34.97245077528638, 40.41697152159076, 46.62021407479787, 53.6519908742748, 61.57438803892328, 70.4374433467642, 80.27433680185693, 91.09646469112653, 102.88958817672014, 115.61211737727078, 129.1924167820028, 143.52609964556228, 158.4774215366037, 173.87972134738078, 189.53656718959672, 205.22664884780193, 220.71018676038994, 235.73429756508966, 250.0391737812906, 263.36691228924997, 275.4678006061165, 286.1085820406525, 295.07979968100665, 302.20375902412735, 307.34004093525454, 310.3893421009462, 311.29588629230904, 310.05139721798395, 306.6946481971194, 301.30749769780715, 294.01201630757066, 284.9679520220316, 274.36554736142375, 262.41983470061257, 249.3639786430313, 235.4407029147922, 220.89414889755702, 205.9635296875055, 190.8776558342157, 175.84926560762048, 161.07028329269446, 146.70909003123222, 132.90684448109704, 119.776763579443, 107.40441443431479, 95.84778002713009, 85.1409573492895, 75.29836096544956, 66.31797928188188, 58.18358184381014, 50.8659997638536, 44.325546376856, 38.51457094461046, 33.37992408820436, 28.865229350147697, 24.912894388631802, 21.46582142831957, 18.468797876595108, 15.869566046511364, 13.619585893238659, 11.674516468348438, 9.994450355932589, 8.543940735834843, 7.291863130216264, 6.211153672048679, 5.278463332053385, 4.473763461815024, 3.7799327863274206, 3.1823501255925475, 2.668511111937787, 2.2276813959913015, 1.8505936110715897, 1.5291909099995298, 1.2564163235218007, 1.026044553612627, 0.8325510734886535, 0.6710124688714386, 0.5370316934306624, 0.4266821764677532, 0.33646535904193864, 0.2632771004651988, 0.2043793629005494, 0.15737454421712724, 0.12018071159742241, 0.09100674056001878, 0.06832696016381794, 0.050855339519455055, 0.03751953313891227, 0.02743525337332742, 0.019881483355874006, 0.01427701150335293, 0.010158685594790266, 0.007161674288843187, 0.005001905707210881, 0.0034607404659573147, 0.002371839544748582, 0.0016101106704354607, 0.0010825620533250913, 0.0007208584292402521, 0.00047535883884393116, 0.00031041494179135043, 0.00020071914860636753, 0.00012850984726355818, 8.146333815147954e-05, 5.1126189878232256e-05, 3.176564895966294e-05, 1.953813600266585e-05, 1.189591803267831e-05, 7.169368304857926e-06, 4.276720210327767e-06, 2.525032600715349e-06, 1.4754644689674024e-06, 8.532490301149664e-07, 4.883013752987609e-07, 2.765319050013204e-07, 1.5496294508920982e-07, 8.592437552579213e-08, 4.714013812190388e-08, 2.558779442551895e-08, 1.3741130260314095e-08, 7.300307061086642e-09, 3.836819360003574e-09, 1.9947628970840013e-09, 1.0258327165502123e-09, 5.218339538259898e-10, 2.625574779813178e-10, 1.3067847248748877e-10, 6.429786481021438e-11, 3.131731318717357e-11, 1.5074874681886285e-11, 7.184439709817525e-12, 3.403215487196576e-12, 1.588773557159584e-12, 7.116796041373163e-13, 3.3935521059902383e-13, 1.6228796084760688e-13, 8.15703060652595e-14, 3.666400516522117e-14, 2.5863755581667648e-14, -1.7053025658242404e-15, 2.4300561562995426e-14, 2.6005864128819668e-14, 1.7621459846850484e-14, 7.318590178329032e-15, 1.7905676941154525e-14, 2.2453150450019167e-14, 3.019806626980426e-16, 2.112088282046898e-14, 3.080202759520034e-14, -4.973799150320702e-15, 8.384404281969182e-15, 7.105427357601002e-16, 1.4921397450962105e-14, 1.3002932064409834e-14, -1.0658141036401502e-15, -1.8047785488306545e-14, 1.2843059948863812e-14, 1.91491267287347e-14, -5.702105454474804e-15, -2.206235194535111e-14, 4.494182803682634e-15, 9.805489753489383e-15, -5.413447468072263e-15, -1.2105871860512708e-14, 9.108269694024785e-15, -4.75397499144492e-15, -1.8953727476400672e-14, -1.6329160246186804e-14, -1.1295409052536344e-14, 1.5198953207118392e-15, -2.863209669357047e-14, -1.653066572515627e-14, -2.0463630789890885e-14, -1.1368683772161604e-14, -4.092726157978177e-14, -2.7284841053187846e-14, -9.094947017729283e-15, -1.8189894035458565e-14, -9.094947017729283e-15, -4.092726157978177e-14, -4.092726157978177e-14, -2.7284841053187846e-14, -4.5474735088646414e-14, -2.2737367544323207e-14, -2.2737367544323207e-14, -2.2737367544323207e-14, -3.637978807091713e-14, -1.8189894035458565e-14, -2.2737367544323207e-14, 0.0, -1.3642420526593923e-14, -1.8189894035458565e-14, -9.094947017729283e-15, -1.8189894035458565e-14, 4.547473508864641e-15, 0.0, -9.094947017729283e-15, 9.094947017729283e-15, -2.0463630789890885e-14, -2.5011104298755527e-14, -6.8212102632969615e-15, -1.1368683772161604e-14, -1.3642420526593923e-14, 4.547473508864641e-15, 1.1368683772161604e-14, 4.547473508864641e-15, 2.2737367544323206e-15, 1.1368683772161603e-15, 7.958078640513123e-15, 4.547473508864641e-15, 8.526512829121202e-15, -5.115907697472721e-15, 1.5347723092418165e-14, 1.3642420526593923e-14, 2.842170943040401e-15, 8.526512829121202e-16, 6.536993168992922e-15, 2.5579538487363606e-15, 1.7905676941154525e-14, 6.252776074688882e-15, 1.4068746168049984e-14, 2.1316282072803005e-15, 1.4210854715202004e-14, -1.7763568394002505e-15, 9.947598300641404e-15, 2.3021584638627248e-14, 3.019806626980426e-16, -2.4691360067663484e-15, -4.618527782440651e-16, 4.263256414560601e-15, 9.521272659185343e-15]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "$\\text{Actual } I_{pd} \\text{ vs. deconvolution of } R_{pd}$", "x": 0.5, "xanchor": "center"}, "xaxis": {"title": {"text": "Day"}}, "yaxis": {"title": {"text": "Count"}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('a4193e80-9c82-460a-9334-818f46693f00');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again our algorithm works nicely.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Discussion">
<a class="anchor" href="#Discussion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Discussion<a class="anchor-link" href="#Discussion"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a lot of papers and research done in the field of deconvolution in general but I have found only one using it in epidemic models (link above).</p>
<p>The theory is skipped here but it is required if we want to use more advanced techniques. I may write another blog post with more details.</p>
<p>After doing this you might be left wondering, well what's the point ?</p>
<p>A few things:</p>
<ul>
<li>If we have daily data of infectious $I_{pd}$ we can then use the deconvolution technique to find an approximation for $E_{pd}$</li>
<li>If we have a close estimate for $E_{pd}$ we can in turn estimate the value of $\beta$ or $R$</li>
<li>We can verify the robusteness of $h_L$ and $h_I$ against real world data and how these vary geographically in a pandemic</li>
</ul>
<p>These points will be studied a bit more in the next blog post.</p>

</div>
</div>
</div>
</div>


</body>
  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="jeffufpost/scattered-thoughts"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/2020/04/02/convolution.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/scattered-thoughts/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/scattered-thoughts/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/scattered-thoughts/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Eclectic collection of thoughts, notebooks, simulations, calculations, and other things on a wide range of topics.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jeffufpost" title="jeffufpost"><svg class="svg-icon grey"><use xlink:href="/scattered-thoughts/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/iamjeffreypost" title="iamjeffreypost"><svg class="svg-icon grey"><use xlink:href="/scattered-thoughts/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
