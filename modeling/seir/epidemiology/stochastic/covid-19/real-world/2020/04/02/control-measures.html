<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Epidemic modeling - Part 6 | Scattered Thoughts</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Epidemic modeling - Part 6" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A quick overview of control measures in times of pandemic/epidemic" />
<meta property="og:description" content="A quick overview of control measures in times of pandemic/epidemic" />
<link rel="canonical" href="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html" />
<meta property="og:url" content="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html" />
<meta property="og:site_name" content="Scattered Thoughts" />
<meta property="og:image" content="https://jeffufpost.github.io/scattered-thoughts/images/control_measures.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-02T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"A quick overview of control measures in times of pandemic/epidemic","headline":"Epidemic modeling - Part 6","@type":"BlogPosting","dateModified":"2020-04-02T00:00:00-05:00","datePublished":"2020-04-02T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html"},"image":"https://jeffufpost.github.io/scattered-thoughts/images/control_measures.png","url":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/scattered-thoughts/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jeffufpost.github.io/scattered-thoughts/feed.xml" title="Scattered Thoughts" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-166290391-2','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/scattered-thoughts/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Epidemic modeling - Part 6 | Scattered Thoughts</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Epidemic modeling - Part 6" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A quick overview of control measures in times of pandemic/epidemic" />
<meta property="og:description" content="A quick overview of control measures in times of pandemic/epidemic" />
<link rel="canonical" href="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html" />
<meta property="og:url" content="https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html" />
<meta property="og:site_name" content="Scattered Thoughts" />
<meta property="og:image" content="https://jeffufpost.github.io/scattered-thoughts/images/control_measures.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-02T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"A quick overview of control measures in times of pandemic/epidemic","headline":"Epidemic modeling - Part 6","@type":"BlogPosting","dateModified":"2020-04-02T00:00:00-05:00","datePublished":"2020-04-02T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html"},"image":"https://jeffufpost.github.io/scattered-thoughts/images/control_measures.png","url":"https://jeffufpost.github.io/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://jeffufpost.github.io/scattered-thoughts/feed.xml" title="Scattered Thoughts" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-166290391-2','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/scattered-thoughts/">Scattered Thoughts</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/scattered-thoughts/about/">About Me</a><a class="page-link" href="/scattered-thoughts/search/">Search</a><a class="page-link" href="/scattered-thoughts/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Epidemic modeling - Part 6</h1><p class="page-description">A quick overview of control measures in times of pandemic/epidemic</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-02T00:00:00-05:00" itemprop="datePublished">
        Apr 2, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#modeling">modeling</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#SEIR">SEIR</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#epidemiology">epidemiology</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#stochastic">stochastic</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#COVID-19">COVID-19</a>
        &nbsp;
      
        <a class="category-tags-link" href="/scattered-thoughts/categories/#real-world">real-world</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/jeffufpost/scattered-thoughts/tree/master/_notebooks/2020-04-02-control-measures.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/scattered-thoughts/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jeffufpost/scattered-thoughts/master?filepath=_notebooks%2F2020-04-02-control-measures.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/scattered-thoughts/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jeffufpost/scattered-thoughts/blob/master/_notebooks/2020-04-02-control-measures.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/scattered-thoughts/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Motivation-for-write-up">Motivation for write-up </a></li>
<li class="toc-entry toc-h2"><a href="#Why-do-we-need-control-measures-during-an-epidemic?">Why do we need control measures during an epidemic? </a></li>
<li class="toc-entry toc-h2"><a href="#Control-measures:-the-basics">Control measures: the basics </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Only-one-way-to-stop-an-epidemic">Only one way to stop an epidemic </a></li>
<li class="toc-entry toc-h3"><a href="#Two-methods-to-save-lives">Two methods to save lives </a></li>
<li class="toc-entry toc-h3"><a href="#Control-measures-in-practice">Control measures in practice </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Reducing-the-proportion-of-Susceptible-in-the-population">Reducing the proportion of Susceptible in the population </a></li>
<li class="toc-entry toc-h2"><a href="#Reducing-$\beta$">Reducing $\beta$ </a></li>
<li class="toc-entry toc-h2"><a href="#Reducing-$\gamma$">Reducing $\gamma$ </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Isolating-positive-tests">Isolating positive tests </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Discussion">Discussion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-02-control-measures.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/jeffufpost/scattered-thoughts/blob/master/_notebooks/2020-04-02-control-measures.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://github.com/jeffufpost/scattered-thoughts/blob/master/_notebooks/my_icons/control_measures.png?raw=1" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivation-for-write-up">
<a class="anchor" href="#Motivation-for-write-up" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation for write-up<a class="anchor-link" href="#Motivation-for-write-up"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the 6th part of a multi-part series blog post on modeling in epidemiology.</p>
<p>The COVID-19 pandemic has brought a lot of attention to the study of epidemiology and more specifically to the various mathematical models that are used to inform public health policies. Everyone has been trying to understand the growth or slowing of new cases and trying to predict the necessary sanitary resources. This blog post attempts to explain the foundations for some of the most used models and enlighten the reader on two key points.</p>
<p>Following the first 5 parts of this blog series, we are left wondering what possible measures can be put in place to control the epidemic.</p>
<p>This 6th installment focuses on this and attempts to elucidate the subject.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Why-do-we-need-control-measures-during-an-epidemic?">
<a class="anchor" href="#Why-do-we-need-control-measures-during-an-epidemic?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why do we need control measures during an epidemic?<a class="anchor-link" href="#Why-do-we-need-control-measures-during-an-epidemic?"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the previous sections we have seen that without control measures in place i.e. when injecting an exposed person into the simulation, depending on the values of $\beta$ and $\gamma$, the virus will spread until it has infected everyone.</p>
<p>There are many reasons why this is bad with a virus as virulent as SARS-CoV-2:</p>
<ul>
<li>Even with a low Case Fatality Rate (CFR), the total death toll will be unacceptable</li>
<li>The strain on sanitary resources of peak sick people will lead to an increase in all-cause deaths</li>
<li>The strain on sanitary resources will lead to increased long-term morbidity</li>
<li>Many economic implications</li>
<li>Many many others...</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Control-measures:-the-basics">
<a class="anchor" href="#Control-measures:-the-basics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Control measures: the basics<a class="anchor-link" href="#Control-measures:-the-basics"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While the previous sections might have left us wondering what we can possibly do to control the pread of the epidemic, the evidence left from those studies in fact leave us with a lot of clues as to where to begin.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Only-one-way-to-stop-an-epidemic">
<a class="anchor" href="#Only-one-way-to-stop-an-epidemic" aria-hidden="true"><span class="octicon octicon-link"></span></a>Only one way to stop an epidemic<a class="anchor-link" href="#Only-one-way-to-stop-an-epidemic"> </a>
</h3>
<p>We have seen there is only one way to stop an epidemic, and that is by having:

$$R \leq 1$$


$$\leftrightarrow R_0~s(t) \leq 1$$


$$\leftrightarrow \frac{\beta}{\gamma}~s(t) \leq 1$$
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Two-methods-to-save-lives">
<a class="anchor" href="#Two-methods-to-save-lives" aria-hidden="true"><span class="octicon octicon-link"></span></a>Two methods to save lives<a class="anchor-link" href="#Two-methods-to-save-lives"> </a>
</h3>
<p>From the equation above, we see an epidemic will either continue until herd immunity is reached:

$$s(t) \leq \frac{1}{R_0}$$


$$\leftrightarrow Immune(t) \geq 1-\frac{1}{R_0}$$
</p>
<p>Or until measures are in place so that:

$$R_0 \leq \frac{1}{s(t)}$$
</p>
<p>In the worst case scenario where $s(t) = 1$ (completely susceptible population), we need:

$$R_0 \leq 1$$


$$\leftrightarrow \beta \leq \gamma$$
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From this results two main ideas of control:</p>
<ol>
<li>
<p>Reaching herd immunity all while controlling peak infectious individuals to within hospital and sanitary resources so as to limit morbidity and mortality</p>
</li>
<li>
<p>Reducing $\beta$ to smaller than $\gamma$ to stop the epidemic even before herd immunity</p>
</li>
</ol>
<p>While the difference between the two is noted here, in practice they are effectively the same.</p>
<p>Option 1 is the same as option 2, with the difference that in 1 we don't quite have $$R\leq 1$$ and so the difference between the two results from different levels of imlementation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Control-measures-in-practice">
<a class="anchor" href="#Control-measures-in-practice" aria-hidden="true"><span class="octicon octicon-link"></span></a>Control measures in practice<a class="anchor-link" href="#Control-measures-in-practice"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have seen three things influence the total number of people that end up infected with the virus:</p>
<ul>
<li>Proportion of Susceptible in population $s(t)$</li>
<li>Value $\beta$</li>
<li>Value of $\gamma$ ($T_{Infectious}$)</li>
</ul>
<p>We have also seen that the peak of infectious individuals could be affected by:</p>
<ul>
<li>Value of $\sigma$ ($T_{Latent}$)</li>
</ul>
<p>And indeed, reducing the peak of infectious at any point comes down to either:</p>
<ul>
<li>
<strong>Reducing the number of S:</strong><ul>
<li>vaccination</li>
<li>prophylactic treatment when potentially exposed </li>
</ul>
</li>
<li>
<strong>Reducing $\beta = r * \rho$ by:</strong><ol>
<li>reducing $r$ i.e. reducing the average number of contacts a person has per day:<ul>
<li>lockdown measures</li>
<li>work from home</li>
<li>closing places where people gather (restaurants, bars, places of worship, etc)</li>
</ul>
</li>
<li>reducing $\rho$ - reducing the pobability of transmitting infection from an infectious to a susceptible via:<ul>
<li>physical distancing</li>
<li>hygiene measures</li>
<li>wearing personal protective equipment (PPE i.e. masks, gloves, etc) </li>
</ul>
</li>
</ol>
</li>
<li>
<strong>Reducing $\gamma$ by:</strong><ul>
<li>Isolation of the sick (mass testing of symptomatic and immediate isolation of positive cases)</li>
<li>Contact-tracing: tracing and quarantining all contacts from infectious people as to quarantine potential exposed before they become infectious</li>
<li>Chemotherapy: treatment to shorten duration of sickness and infectious period</li>
</ul>
</li>
<li>
<strong>Increasing $\sigma$ by:</strong><ul>
<li>prophylactic treatment when potentially exposed</li>
</ul>
</li>
</ul>
<p>All these are the same requirements to reduce $R \leq 1$.</p>
<p>Let's try to quantify the impact of each measure below.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="o">!</span>pip install <span class="nv">plotly</span><span class="o">==</span><span class="m">4</span>.8.2
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">expon</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">weibull_min</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting plotly==4.8.2
  Downloading https://files.pythonhosted.org/packages/27/99/9794bcd22fae2e12b689759d53fe26939a4d11b8b44b0b7056e035c64529/plotly-4.8.2-py2.py3-none-any.whl (11.5MB)
     |████████████████████████████████| 11.5MB 3.3MB/s 
Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from plotly==4.8.2) (1.12.0)
Requirement already satisfied: retrying&gt;=1.3.3 in /usr/local/lib/python3.6/dist-packages (from plotly==4.8.2) (1.3.3)
Installing collected packages: plotly
  Found existing installation: plotly 4.4.1
    Uninstalling plotly-4.4.1:
      Successfully uninstalled plotly-4.4.1
Successfully installed plotly-4.8.2
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1"># Need this new function for model below:</span>
<span class="k">def</span> <span class="nf">make_df</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">'S'</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'State'</span><span class="p">])</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">'Day'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">tochange</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_E</span><span class="o">+</span><span class="n">num_I</span><span class="o">+</span><span class="n">num_R</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="s1">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tochange</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_E</span><span class="p">],</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'E'</span>
  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tochange</span><span class="p">[</span><span class="n">num_E</span><span class="p">:</span><span class="n">num_I</span><span class="o">+</span><span class="n">num_E</span><span class="p">],</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'I'</span>
  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tochange</span><span class="p">[</span><span class="n">num_E</span><span class="o">+</span><span class="n">num_I</span><span class="p">:</span><span class="n">num_E</span><span class="o">+</span><span class="n">num_I</span><span class="o">+</span><span class="n">num_R</span><span class="p">],</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'R'</span>
  <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1"># regular Stoachastic SEIR model below:</span>
<span class="k">def</span> <span class="nf">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="p">,</span> <span class="n">iso_n</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="p">,</span> <span class="n">lockdown</span><span class="p">):</span>

    <span class="c1"># Initialize population dataframe with data given by user</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">)</span>
    
    <span class="c1"># This variable is used to track daily value of beta</span>
    <span class="n">xxbeta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Initialize the arrays to return</span>
    <span class="c1"># Below are numbers of S, E, I, R total</span>
    <span class="n">S</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">I</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Below are the daily additions in S, E, I, R</span>
    <span class="n">Spd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">Epd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">Ipd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">Rpd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">b</span><span class="o">=</span><span class="n">beta</span>
    <span class="n">beta2</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">10</span>
    <span class="n">beta3</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">10</span>

    <span class="n">lockdown_date</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="c1"># Stochastic model so use random values to decide on progression</span>
    <span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">days</span><span class="p">))</span>

    <span class="c1"># Depending if you want exponential or gamma distribution for sigma</span>
    <span class="n">EtoI</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">5.2</span><span class="o">-</span><span class="mf">1.8</span><span class="p">)</span><span class="o">/</span><span class="mf">0.9</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># Depending if you want exponential or gamma distribution for gamma and if you have isolation or not</span>
    <span class="c1"># Uses distributiosn found on blog part 3</span>
    <span class="k">if</span> <span class="n">isolation</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">ItoR</span> <span class="o">=</span> <span class="n">iso_n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">ItoR</span> <span class="o">=</span> <span class="n">weibull_min</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">20.11</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>   


    <span class="c1"># Iterate over every day the simulation is run</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">days</span><span class="p">):</span>

        <span class="c1"># Record daily beta values</span>
        <span class="n">xxbeta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xxbeta</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="c1"># First we get the index of the individuals that will change state today:</span>

        <span class="c1"># Random number tells you which 'S' have been exposed on this day </span>
        <span class="n">StoE_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="s1">'S'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rand</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'I'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">p</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>

        <span class="c1"># For each row, if a person has been a certain number of days in E, they will go to I</span>
        <span class="c1"># This follows EtoI variable which is either exponential or gamma distributed according to above</span>
        <span class="n">EtoI_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="s1">'E'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">df</span><span class="o">.</span><span class="n">Day</span> <span class="o">&gt;=</span> <span class="n">EtoI</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
        
        <span class="c1"># Similaraly as above</span>
        <span class="c1"># For each row, if a person has been a certain number of days in I, they will go to R</span>
        <span class="c1"># This follows EtoI variable which is either exponential or gamma distributed according to above</span>
        <span class="n">ItoR_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span> <span class="o">==</span> <span class="s1">'I'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">df</span><span class="o">.</span><span class="n">Day</span> <span class="o">&gt;=</span> <span class="n">ItoR</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>

        <span class="c1"># Use indexes collected above to populate per day values</span>
        <span class="n">Epd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Epd</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">StoE_index</span><span class="p">))</span>
        <span class="n">Ipd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ipd</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">EtoI_index</span><span class="p">))</span>
        <span class="n">Rpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rpd</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ItoR_index</span><span class="p">))</span>

        <span class="c1"># Append the S, E, I, and R arrays</span>
        <span class="n">S</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'S'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'E'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">I</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'I'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">State</span><span class="o">==</span><span class="s1">'R'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c1"># Now we use the indexes collected above randomly to change the actual population dataframe to the new states</span>
        <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ItoR_index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'R'</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">EtoI_index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'I'</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">StoE_index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'E'</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Code below for control measures to reduce beta values</span>
        <span class="k">if</span> <span class="n">lockdown</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
          <span class="k">if</span> <span class="p">((</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Ipd</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">39</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">lockdown_date</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">lockdown_date</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">beta2</span>
          <span class="k">elif</span> <span class="p">((</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Ipd</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">)):</span> 
            <span class="n">b</span> <span class="o">=</span> <span class="n">beta3</span>
        
    <span class="n">Epd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">num_E</span>
    <span class="n">Ipd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">num_I</span>
    <span class="n">Rpd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">num_R</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">R</span><span class="p">,</span> <span class="n">Epd</span><span class="p">,</span> <span class="n">Ipd</span><span class="p">,</span> <span class="n">Rpd</span><span class="p">,</span> <span class="n">xxbeta</span><span class="p">,</span> <span class="n">lockdown_date</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reducing-the-proportion-of-Susceptible-in-the-population">
<a class="anchor" href="#Reducing-the-proportion-of-Susceptible-in-the-population" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reducing the proportion of Susceptible in the population<a class="anchor-link" href="#Reducing-the-proportion-of-Susceptible-in-the-population"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we have seen, reducing the proportion of susceptible in the population helps reduce the impact of the epidemic.</p>
<p>In the first blog post of the series, we derived the threshold for herd immunity as being $1-\frac{1}{R_0}$.</p>
<p>In our simulations we have $R_0 = \frac{\beta}{\gamma} = \frac{0.5}{\frac{1}{20.62}} = 10.31$</p>
<p>And so, the herd immunity threshold in our simulation should be:

$$HIT = \frac{9.31}{10.31}~100\% = 90.3\%$$
</p>
<p>Let's run the model with the initial condition that 92% are in the R state already.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1"># Define parameters for stochastic model</span>
<span class="n">days</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">num_E</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_I</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Run 2 simulations, one above HIT, and one below:</span>
<span class="n">num_R1</span> <span class="o">=</span> <span class="mi">8000</span> 
<span class="n">num_R2</span> <span class="o">=</span> <span class="mi">9200</span>
<span class="n">beta_stoch</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>

<span class="c1"># Run 4 stochastic simulations, 2 with exponential sigma, 2 with gamma sigmalation, iso_n, contact_tracing, lockdown</span>
<span class="n">results_stoch0</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R1</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">results_stoch1</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R2</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n1</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-4-b1cb4735df63&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span> 
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span class="ansi-red-fg"># Run 4 stochastic simulations, 2 with exponential sigma, 2 with gamma sigmalation, iso_n, contact_tracing, lockdown</span>
<span class="ansi-green-fg">---&gt; 14</span><span class="ansi-red-fg"> </span>results_stoch0 <span class="ansi-blue-fg">=</span> seir_model_stoch_ctrl<span class="ansi-blue-fg">(</span>beta_stoch<span class="ansi-blue-fg">,</span> p<span class="ansi-blue-fg">,</span> num_E<span class="ansi-blue-fg">,</span> num_I<span class="ansi-blue-fg">,</span> num_R1<span class="ansi-blue-fg">,</span> days<span class="ansi-blue-fg">,</span> isolation<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> iso_n<span class="ansi-blue-fg">=</span>iso_n<span class="ansi-blue-fg">,</span> contact_tracing<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> lockdown<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> results_stoch1 <span class="ansi-blue-fg">=</span> seir_model_stoch_ctrl<span class="ansi-blue-fg">(</span>beta_stoch<span class="ansi-blue-fg">,</span> p<span class="ansi-blue-fg">,</span> num_E<span class="ansi-blue-fg">,</span> num_I<span class="ansi-blue-fg">,</span> num_R2<span class="ansi-blue-fg">,</span> days<span class="ansi-blue-fg">,</span> isolation<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> iso_n<span class="ansi-blue-fg">=</span>iso_n1<span class="ansi-blue-fg">,</span> contact_tracing<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> lockdown<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name 'iso_n' is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>    
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_below_HIT'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_above_HIT'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch1</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s1">'Day'</span><span class="p">,</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s1">'Proportion of population'</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span><span class="sa">r</span><span class="s1">'$\text{Effect of herd immunity on SEIR model}$'</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span><span class="s1">'center'</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reducing-$\beta$">
<a class="anchor" href="#Reducing-%24%5Cbeta%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reducing $\beta$<a class="anchor-link" href="#Reducing-%24%5Cbeta%24"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See blog post 2 for effect of $\beta$ on the SEIR model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reducing-$\gamma$">
<a class="anchor" href="#Reducing-%24%5Cgamma%24" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reducing $\gamma$<a class="anchor-link" href="#Reducing-%24%5Cgamma%24"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Isolating-positive-tests">
<a class="anchor" href="#Isolating-positive-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Isolating positive tests<a class="anchor-link" href="#Isolating-positive-tests"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Say you isolate positive tests and are able to test everyone.</p>
<p>What if tests are positive $n$ days after people are infectious ?</p>
<p>You can isolate people after $n$ days and this effectively reduces $T_{Infectious}$ to $n$ days.</p>
<p>Let's plot the total infectious individuals with:</p>
<ul>
<li>n = 10 days</li>
<li>n = 7 days</li>
<li>n = 5 days</li>
<li>n = 2 days</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="c1"># Define parameters for stochastic model</span>
<span class="n">days</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">num_E</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_I</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_R</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">beta_stoch</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>

<span class="c1"># Isolate after iso_n days</span>
<span class="n">iso_n1</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Test and isolate all infectious after 10 days</span>
<span class="n">iso_n2</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iso_n3</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">iso_n4</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Run 4 stochastic simulations, 2 with exponential sigma, 2 with gamma sigmalation, iso_n, contact_tracing, lockdown</span>
<span class="n">results_stoch0</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">results_stoch1</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n1</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">results_stoch2</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n2</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">results_stoch3</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n3</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">results_stoch4</span> <span class="o">=</span> <span class="n">seir_model_stoch_ctrl</span><span class="p">(</span><span class="n">beta_stoch</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_E</span><span class="p">,</span> <span class="n">num_I</span><span class="p">,</span> <span class="n">num_R</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">isolation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iso_n</span><span class="o">=</span><span class="n">iso_n4</span><span class="p">,</span> <span class="n">contact_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lockdown</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>    
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_no_isolation'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_iso10'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch1</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_iso7'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch2</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_iso5'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch3</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'I_iso2'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results_stoch4</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">results_stoch4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s1">'Day'</span><span class="p">,</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s1">'Proportion of population'</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'text'</span><span class="p">:</span><span class="sa">r</span><span class="s1">'$\text{Effect of early testing and isolation on SEIR model}$'</span><span class="p">,</span>
        <span class="s1">'x'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">'xanchor'</span><span class="p">:</span><span class="s1">'center'</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Clearly, early testing and isolation of cases reduces transmission and this the peak of infectious individuals. The faster we do this the better.</p>
<p>If we catch infectious individuals early enough, we can completely control the epidemic (see I_iso_2 above).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion">
<a class="anchor" href="#Discussion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Discussion<a class="anchor-link" href="#Discussion"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This was a quick introduction to the basics of control measures and their impact on the SEIR model.</p>
<p>While there are many different possible approaches, the accumulation of the different solutions is the way to achieve control over an epidemic.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Maybe I will make an interactive app to see the effect of each effect.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="jeffufpost/scattered-thoughts"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/scattered-thoughts/modeling/seir/epidemiology/stochastic/covid-19/real-world/2020/04/02/control-measures.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/scattered-thoughts/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/scattered-thoughts/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/scattered-thoughts/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Eclectic collection of thoughts, notebooks, simulations, calculations, and other things on a wide range of topics.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jeffufpost" title="jeffufpost"><svg class="svg-icon grey"><use xlink:href="/scattered-thoughts/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/iamjeffreypost" title="iamjeffreypost"><svg class="svg-icon grey"><use xlink:href="/scattered-thoughts/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
